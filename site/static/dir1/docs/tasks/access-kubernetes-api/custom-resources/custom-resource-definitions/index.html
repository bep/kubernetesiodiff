<html>
<body>
<h1>
  Extend the Kubernetes API with CustomResourceDefinitions
</h1>
<p>
  <a href="https://github.com/kubernetes/website/edit/master/content/en/docs/tasks/access-kubernetes-api/custom-resources/custom-resource-definitions.md" id="editPageButton" target="_blank">
    Edit This Page
  </a>
</p>
<h1>
  Extend the Kubernetes API with CustomResourceDefinitions
</h1>
<p>
  This page shows how to install a
  <a href="/docs/concepts/extend-kubernetes/api-extension/custom-resources/">
    custom resource
  </a>
  into the Kubernetes API by creating a
  <a href="/docs/reference/generated/kubernetes-api/v1.18/#customresourcedefinition-v1beta1-apiextensions">
    CustomResourceDefinition
  </a>
  .
</p>
<ul id="markdown-toc">
  <li>
    <a href="#before-you-begin">
      Before you begin
    </a>
  </li>
  <li>
    <a href="#create-a-customresourcedefinition">
      Create a CustomResourceDefinition
    </a>
  </li>
  <li>
    <a href="#create-custom-objects">
      Create custom objects
    </a>
  </li>
  <li>
    <a href="#delete-a-customresourcedefinition">
      Delete a CustomResourceDefinition
    </a>
  </li>
  <li>
    <a href="#specifying-a-structural-schema">
      Specifying a structural schema
    </a>
  </li>
  <li>
    <a href="#serving-multiple-versions-of-a-crd">
      Serving multiple versions of a CRD
    </a>
  </li>
  <li>
    <a href="#advanced-topics">
      Advanced topics
    </a>
  </li>
  <li>
    <a href="#what-s-next">
      What's next
    </a>
  </li>
</ul>
<h2 id="before-you-begin">
  Before you begin
</h2>
<p>
  You need to have a Kubernetes cluster, and the kubectl command-line tool must
  be configured to communicate with your cluster. If you do not already have a
  cluster, you can create one by using
  <a href="/docs/setup/learning-environment/minikube/">
    Minikube
  </a>
  ,
  or you can use one of these Kubernetes playgrounds:
</p>
<ul>
  <li>
    <a href="https://www.katacoda.com/courses/kubernetes/playground">
      Katacoda
    </a>
  </li>
  <li>
    <a href="http://labs.play-with-k8s.com/">
      Play with Kubernetes
    </a>
  </li>
</ul>
<p>
  To check the version, enter
  <code>
    kubectl version
  </code>
  .
</p>
<ul>
  <li>
    <p>
      Make sure your Kubernetes cluster has a master version of 1.16.0 or higher to use
      <code>
        apiextensions.k8s.io/v1
      </code>
      , or 1.7.0 or higher for
      <code>
        apiextensions.k8s.io/v1beta1
      </code>
      .
    </p>
  </li>
  <li>
    <p>
      Read about
      <a href="/docs/concepts/api-extension/custom-resources/">
        custom resources
      </a>
      .
    </p>
  </li>
</ul>
<h2 id="create-a-customresourcedefinition">
  Create a CustomResourceDefinition
</h2>
<p>
  When you create a new CustomResourceDefinition (CRD), the Kubernetes API Server
  creates a new RESTful resource path for each version you specify. The CRD can be
  either namespaced or cluster-scoped, as specified in the CRD&rsquo;s
  <code>
    scope
  </code>
  field. As
  with existing built-in objects, deleting a namespace deletes all custom objects
  in that namespace. CustomResourceDefinitions themselves are non-namespaced and
  are available to all namespaces.
</p>
<p>
  For example, if you save the following CustomResourceDefinition to
  <code>
    resourcedefinition.yaml
  </code>
  :
</p>
<div id="customresourcedefinition-example-1">
<ul>
  <li>
    <a href="#customresourcedefinition-example-1-0">
      apiextensions.k8s.io/v1
    </a>
  </li>
  <li>
    <a href="#customresourcedefinition-example-1-1">
      apiextensions.k8s.io/v1beta1
    </a>
  </li>
</ul>
<div id="customresourcedefinition-example-1-0">
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>apiextensions.k8s.io/v1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CustomResourceDefinition<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#080;font-style:italic"># name must match the spec fields below, and be in the form: &lt;plural&gt;.&lt;group&gt;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>crontabs.stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#080;font-style:italic"># group name to use for REST API: /apis/&lt;group&gt;/&lt;version&gt;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">group</span>:<span style="color:#bbb"> </span>stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#080;font-style:italic"># list of versions supported by this CustomResourceDefinition</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">versions</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#080;font-style:italic"># Each version can be enabled/disabled by Served flag.</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">served</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#080;font-style:italic"># One and only one version must be marked as the storage version.</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">storage</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">openAPIV3Schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#080;font-style:italic"># either Namespaced or Cluster</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">scope</span>:<span style="color:#bbb"> </span>Namespaced<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">names</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic"># plural name to be used in the URL: /apis/&lt;group&gt;/&lt;version&gt;/&lt;plural&gt;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">plural</span>:<span style="color:#bbb"> </span>crontabs<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic"># singular name to be used as an alias on the CLI and for display</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">singular</span>:<span style="color:#bbb"> </span>crontab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic"># kind is normally the CamelCased singular type. Your resource manifests use this.</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic"># shortNames allow shorter string to match your resource on the CLI</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">shortNames</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- ct</code></pre>
  </div>
  <p>
</div>
<div id="customresourcedefinition-example-1-1">
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#080;font-style:italic"># Deprecated in v1.16 in favor of apiextensions.k8s.io/v1</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>apiextensions.k8s.io/v1beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CustomResourceDefinition<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#080;font-style:italic"># name must match the spec fields below, and be in the form: &lt;plural&gt;.&lt;group&gt;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>crontabs.stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#080;font-style:italic"># group name to use for REST API: /apis/&lt;group&gt;/&lt;version&gt;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">group</span>:<span style="color:#bbb"> </span>stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#080;font-style:italic"># list of versions supported by this CustomResourceDefinition</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">versions</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#080;font-style:italic"># Each version can be enabled/disabled by Served flag.</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">served</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#080;font-style:italic"># One and only one version must be marked as the storage version.</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">storage</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#080;font-style:italic"># either Namespaced or Cluster</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">scope</span>:<span style="color:#bbb"> </span>Namespaced<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">names</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic"># plural name to be used in the URL: /apis/&lt;group&gt;/&lt;version&gt;/&lt;plural&gt;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">plural</span>:<span style="color:#bbb"> </span>crontabs<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic"># singular name to be used as an alias on the CLI and for display</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">singular</span>:<span style="color:#bbb"> </span>crontab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic"># kind is normally the CamelCased singular type. Your resource manifests use this.</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic"># shortNames allow shorter string to match your resource on the CLI</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">shortNames</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- ct<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">preserveUnknownFields</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">false</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">validation</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">openAPIV3Schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer</code></pre>
  </div>
  <p>
</div>
<p>
<script>
  $(function(){$("#customresourcedefinition-example-1").tabs();});
</script>
<p>
  And create it:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl apply -f resourcedefinition.yaml</code></pre>
</div>
<p>
  Then a new namespaced RESTful API endpoint is created at:
</p><pre><code>/apis/stable.example.com/v1/namespaces/*/crontabs/...</code></pre>
<p>
  This endpoint URL can then be used to create and manage custom objects.
  The
  <code>
    kind
  </code>
  of these objects will be
  <code>
    CronTab
  </code>
  from the spec of the
  CustomResourceDefinition object you created above.
</p>
<p>
  It might take a few seconds for the endpoint to be created.
  You can watch the
  <code>
    Established
  </code>
  condition of your CustomResourceDefinition
  to be true or watch the discovery information of the API server for your
  resource to show up.
</p>
<h2 id="create-custom-objects">
  Create custom objects
</h2>
<p>
  After the CustomResourceDefinition object has been created, you can create
  custom objects. Custom objects can contain custom fields. These fields can
  contain arbitrary JSON.
  In the following example, the
  <code>
    cronSpec
  </code>
  and
  <code>
    image
  </code>
  custom fields are set in a
  custom object of kind
  <code>
    CronTab
  </code>
  .  The kind
  <code>
    CronTab
  </code>
  comes from the spec of the
  CustomResourceDefinition object you created above.
</p>
<p>
  If you save the following YAML to
  <code>
    my-crontab.yaml
  </code>
  :
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;stable.example.com/v1&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>my-new-cron-object<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;* * * * */5&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>my-awesome-cron-image</code></pre>
</div>
<p>
  and create it:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl apply -f my-crontab.yaml</code></pre>
</div>
<p>
  You can then manage your CronTab objects using kubectl. For example:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl get crontab</code></pre>
</div>
<p>
  Should print a list like this:
</p><pre><code class="language-console" data-lang="console">NAME                 AGE
my-new-cron-object   6s</code></pre>
<p>
  Resource names are not case-sensitive when using kubectl, and you can use either
  the singular or plural forms defined in the CRD, as well as any short names.
</p>
<p>
  You can also view the raw YAML data:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl get ct -o yaml</code></pre>
</div>
<p>
  You should see that it contains the custom
  <code>
    cronSpec
  </code>
  and
  <code>
    image
  </code>
  fields
  from the yaml you used to create it:
</p><pre><code class="language-console" data-lang="console">apiVersion: v1
kind: List
items:
- apiVersion: stable.example.com/v1
  kind: CronTab
  metadata:
    creationTimestamp: 2017-05-31T12:56:35Z
    generation: 1
    name: my-new-cron-object
    namespace: default
    resourceVersion: &#34;285&#34;
    uid: 9423255b-4600-11e7-af6a-28d2447dc82b
  spec:
    cronSpec: &#39;* * * * */5&#39;
    image: my-awesome-cron-image
metadata:
  resourceVersion: &#34;&#34;</code></pre>
<h2 id="delete-a-customresourcedefinition">
  Delete a CustomResourceDefinition
</h2>
<p>
  When you delete a CustomResourceDefinition, the server will uninstall the RESTful API  endpoint
  and
  <strong>
    delete all custom objects stored in it
  </strong>
  .
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl delete -f resourcedefinition.yaml
kubectl get crontabs</code></pre>
</div><pre><code class="language-console" data-lang="console">Error from server (NotFound): Unable to list {&#34;stable.example.com&#34; &#34;v1&#34; &#34;crontabs&#34;}: the server could not find the requested resource (get crontabs.stable.example.com)</code></pre>
<p>
  If you later recreate the same CustomResourceDefinition, it will start out empty.
</p>
<h2 id="specifying-a-structural-schema">
  Specifying a structural schema
</h2>
<div style="margin-top: 10px; margin-bottom: 10px;">
  <b>
    FEATURE STATE:
  </b>
  <code>
    Kubernetes v1.16
  </code>
  <a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all">
    <span class="ui-icon ui-icon-newwin"></span>
    stable
  </a>
  <div id="feature-state-dialog" class="ui-dialog-content" title="stable">
    <p>
      This feature is
      <em>
        stable
      </em>
      , meaning:
    </p>
    <ul>
      <li>
        The version name is vX where X is an integer.
      </li>
      <li>
        Stable versions of features will appear in released software for many subsequent versions.
      </li>
    </ul>
  </div>
  <script>
    $(function(){

    $( "#feature-state-dialog" ).dialog({
    autoOpen: false,
    width: "600",
    buttons: [
    {
    text: "Ok",
    click: function() {
    $( this ).dialog( "close" );
    }
    }
    ]
    });


    $( "#feature-state-dialog-link" ).click(function( event ) {
    $( "#feature-state-dialog" ).dialog( "open" );
    event.preventDefault();
    });

    });
  </script>
</div>
<p>
  CustomResources traditionally store arbitrary JSON (next to
  <code>
    apiVersion
  </code>
  ,
  <code>
    kind
  </code>
  and
  <code>
    metadata
  </code>
  , which is validated by the API server implicitly). With
  <a href="/docs/tasks/access-kubernetes-api/extend-api-custom-resource-definitions/#validation">
    OpenAPI v3.0 validation
  </a>
  a schema can be specified, which is validated during creation and updates, compare below for details and limits of such a schema.
</p>
<p>
  With
  <code>
    apiextensions.k8s.io/v1
  </code>
  the definition of a structural schema is mandatory for CustomResourceDefinitions, while in
  <code>
    v1beta1
  </code>
  this is still optional.
</p>
<p>
  A structural schema is an
  <a href="/docs/tasks/access-kubernetes-api/extend-api-custom-resource-definitions/#validation">
    OpenAPI v3.0 validation schema
  </a>
  which:
</p>
<ol>
  <li>
    specifies a non-empty type (via
    <code>
      type
    </code>
    in OpenAPI) for the root, for each specified field of an object node (via
    <code>
      properties
    </code>
    or
    <code>
      additionalProperties
    </code>
    in OpenAPI) and for each item in an array node (via
    <code>
      items
    </code>
    in OpenAPI), with the exception of:
    <ul>
      <li>
        a node with
        <code>
          x-kubernetes-int-or-string: true
        </code>
      </li>
      <li>
        a node with
        <code>
          x-kubernetes-preserve-unknown-fields: true
        </code>
      </li>
    </ul>
  </li>
  <li>
    for each field in an object and each item in an array which is specified within any of
    <code>
      allOf
    </code>
    ,
    <code>
      anyOf
    </code>
    ,
    <code>
      oneOf
    </code>
    or
    <code>
      not
    </code>
    , the schema also specifies the field/item outside of those logical junctors (compare example 1 and 2).
  </li>
  <li>
    does not set
    <code>
      description
    </code>
    ,
    <code>
      type
    </code>
    ,
    <code>
      default
    </code>
    ,
    <code>
      additionalProperties
    </code>
    ,
    <code>
      nullable
    </code>
    within an
    <code>
      allOf
    </code>
    ,
    <code>
      anyOf
    </code>
    ,
    <code>
      oneOf
    </code>
    or
    <code>
      not
    </code>
    , with the exception of the two pattern for
    <code>
      x-kubernetes-int-or-string: true
    </code>
    (see below).
  </li>
  <li>
    if
    <code>
      metadata
    </code>
    is specified, then only restrictions on
    <code>
      metadata.name
    </code>
    and
    <code>
      metadata.generateName
    </code>
    are allowed.
  </li>
</ol>
<p>
  Non-Structural Example 1:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">allOf</span>:<span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>...</code></pre>
</div>
<p>
  conflicts with rule 2. The following would be correct:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>...<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">allOf</span>:<span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>...</code></pre>
</div>
<p>
  Non-Structural Example 2:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">allOf</span>:<span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#a2f;font-weight:bold">items</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>...</code></pre>
</div>
<p>
  conflicts with rule 2. The following would be correct:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">items</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>...<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">allOf</span>:<span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#a2f;font-weight:bold">items</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>...</code></pre>
</div>
<p>
  Non-Structural Example 3:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">pattern</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;abc&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">pattern</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;^a&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">finalizers</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>array<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">items</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">pattern</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;my-finalizer&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">anyOf</span>:<span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">bar</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">minimum</span>:<span style="color:#bbb"> </span><span style="color:#666">42</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">required</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">&#34;bar&#34;</span>]<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">description</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;foo bar object&#34;</span></code></pre>
</div>
<p>
  is not a structural schema because of the following violations:
</p>
<ul>
  <li>
    the type at the root is missing (rule 1).
  </li>
  <li>
    the type of
    <code>
      foo
    </code>
    is missing (rule 1).
  </li>
  <li>
    <code>
      bar
    </code>
    inside of
    <code>
      anyOf
    </code>
    is not specified outside (rule 2).
  </li>
  <li>
    <code>
      bar
    </code>
    &rsquo;s
    <code>
      type
    </code>
    is within
    <code>
      anyOf
    </code>
    (rule 3).
  </li>
  <li>
    the description is set within
    <code>
      anyOf
    </code>
    (rule 3).
  </li>
  <li>
    <code>
      metadata.finalizer
    </code>
    might not be restricted (rule 4).
  </li>
</ul>
<p>
  In contrast, the following, corresponding schema is structural:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">description</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;foo bar object&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">pattern</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;abc&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">bar</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">pattern</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;^a&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">anyOf</span>:<span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">bar</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">minimum</span>:<span style="color:#bbb"> </span><span style="color:#666">42</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">required</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">&#34;bar&#34;</span>]</code></pre>
</div>
<p>
  Violations of the structural schema rules are reported in the
  <code>
    NonStructural
  </code>
  condition in the CustomResourceDefinition.
</p>
<p>
  Structural schemas are a requirement for
  <code>
    apiextensions.k8s.io/v1
  </code>
  , and disables the following  features for
  <code>
    apiextensions.k8s.io/v1beta1
  </code>
  :
</p>
<ul>
  <li>
    <a href="/docs/tasks/access-kubernetes-api/extend-api-custom-resource-definitions/#publish-validation-schema-in-openapi-v2">
      Validation Schema Publishing
    </a>
  </li>
  <li>
    <a href="/docs/tasks/access-kubernetes-api/custom-resources/custom-resource-definition-versioning/#webhook-conversion">
      Webhook Conversion
    </a>
  </li>
  <li>
    <a href="#preserving-unknown-fields">
      Pruning
    </a>
  </li>
</ul>
<h3 id="pruning-versus-preserving-unknown-fields">
  Pruning versus preserving unknown fields
</h3>
<div style="margin-top: 10px; margin-bottom: 10px;">
  <b>
    FEATURE STATE:
  </b>
  <code>
    Kubernetes v1.16
  </code>
  <a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all">
    <span class="ui-icon ui-icon-newwin"></span>
    stable
  </a>
  <div id="feature-state-dialog" class="ui-dialog-content" title="stable">
    <p>
      This feature is
      <em>
        stable
      </em>
      , meaning:
    </p>
    <ul>
      <li>
        The version name is vX where X is an integer.
      </li>
      <li>
        Stable versions of features will appear in released software for many subsequent versions.
      </li>
    </ul>
  </div>
  <script>
    $(function(){

    $( "#feature-state-dialog" ).dialog({
    autoOpen: false,
    width: "600",
    buttons: [
    {
    text: "Ok",
    click: function() {
    $( this ).dialog( "close" );
    }
    }
    ]
    });


    $( "#feature-state-dialog-link" ).click(function( event ) {
    $( "#feature-state-dialog" ).dialog( "open" );
    event.preventDefault();
    });

    });
  </script>
</div>
<p>
  CustomResourceDefinitions traditionally store any (possibly validated) JSON as is in etcd. This means that unspecified fields (if there is a
  <a href="/docs/tasks/access-kubernetes-api/extend-api-custom-resource-definitions/#validation">
    OpenAPI v3.0 validation schema
  </a>
  at all) are persisted. This is in contrast to native Kubernetes resources such as a pod where unknown fields are dropped before being persisted to etcd. We call this &ldquo;pruning&rdquo; of unknown fields.
</p>
<div id="customresourcedefinition-pruning">
  <ul>
    <li>
      <a href="#customresourcedefinition-pruning-0">
        apiextensions.k8s.io/v1
      </a>
    </li>
    <li>
      <a href="#customresourcedefinition-pruning-1">
        apiextensions.k8s.io/v1beta1
      </a>
    </li>
  </ul>
  <div id="customresourcedefinition-pruning-0">
    <p>
      For CustomResourceDefinitions created in
      <code>
        apiextensions.k8s.io/v1
      </code>
      ,
      <a href="#specifying-a-structural-schema">
        structural OpenAPI v3 validation schemas
      </a>
      are required and pruning is enabled and cannot be disabled (note that CRDs converted from
      <code>
        apiextensions.k8s.io/v1beta1
      </code>
      to
      <code>
        apiextensions.k8s.io/v1
      </code>
      might lack structural schemas, and
      <code>
        spec.preserveUnknownFields
      </code>
      might be
      <code>
        true
      </code>
      ).
    </p>
  </div>
  <div id="customresourcedefinition-pruning-1">
    <p>
      For CustomResourceDefinitions created in
      <code>
        apiextensions.k8s.io/v1beta1
      </code>
      , if a
      <a href="#specifying-a-structural-schema">
        structural OpenAPI v3 validation schema
      </a>
      is defined (either in the global
      <code>
        spec.validation.openAPIV3Schema
      </code>
      in
      <code>
        apiextensions.k8s.io/v1beta1
      </code>
      or for each version) in a CustomResourceDefinition, pruning can be enabled by setting
      <code>
        spec.preserveUnknownFields
      </code>
      to
      <code>
        false
      </code>
      .
    </p>
  </div>
  <p>
</div>
<script>
  $(function(){$("#customresourcedefinition-pruning").tabs();});
</script>
<p>
  If pruning is enabled, unspecified fields in CustomResources on creation and on update are dropped.
</p>
<p>
  Compare the CustomResourceDefinition
  <code>
    crontabs.stable.example.com
  </code>
  above. It has pruning enabled (both in
  <code>
    apiextensions.k8s.io/v1
  </code>
  and
  <code>
    apiextensions.k8s.io/v1beta1
  </code>
  ). Hence, if you save the following YAML to
  <code>
    my-crontab.yaml
  </code>
  :
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;stable.example.com/v1&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>my-new-cron-object<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;* * * * */5&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>my-awesome-cron-image<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">someRandomField</span>:<span style="color:#bbb"> </span><span style="color:#666">42</span></code></pre>
</div>
<p>
  and create it:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl create --validate<span style="color:#666">=</span><span style="color:#a2f">false</span> -f my-crontab.yaml -o yaml</code></pre>
</div>
<p>
  you should get:
</p><pre><code class="language-console" data-lang="console">apiVersion: stable.example.com/v1
kind: CronTab
metadata:
  creationTimestamp: 2017-05-31T12:56:35Z
  generation: 1
  name: my-new-cron-object
  namespace: default
  resourceVersion: &#34;285&#34;
  uid: 9423255b-4600-11e7-af6a-28d2447dc82b
spec:
  cronSpec: &#39;* * * * */5&#39;
  image: my-awesome-cron-image</code></pre>
<p>
  The field
  <code>
    someRandomField
  </code>
  has been pruned.
</p>
<p>
  Note that the
  <code>
    kubectl create
  </code>
  call uses
  <code>
    --validate=false
  </code>
  to skip client-side validation. Because the
  <a href="/docs/tasks/access-kubernetes-api/extend-api-custom-resource-definitions/#publish-validation-schema-in-openapi-v2">
    OpenAPI validation schemas are also published
  </a>
  to kubectl, it will also check for unknown fields and reject those objects long before they are sent to the API server.
</p>
<h3 id="controlling-pruning">
  Controlling pruning
</h3>
<p>
  If pruning is enabled (enforced in
  <code>
    apiextensions.k8s.io/v1
  </code>
  , or as opt-in via
  <code>
    spec.preserveUnknownField: false
  </code>
  in
  <code>
    apiextensions.k8s.io/v1beta1
  </code>
  ) in the CustomResourceDefinition, all unspecified fields in custom resources of that type and in all versions are pruned. It is possible though to opt-out of that for JSON sub-trees via
  <code>
    x-kubernetes-preserve-unknown-fields: true
  </code>
  in the
  <a href="#specifying-a-structural-schema">
    structural OpenAPI v3 validation schema
  </a>
  :
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">json</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">x-kubernetes-preserve-unknown-fields</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span></code></pre>
</div>
<p>
  The field
  <code>
    json
  </code>
  can store any JSON value, without anything being pruned.
</p>
<p>
  It is possible to partially specify the permitted JSON, e.g.:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">json</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">x-kubernetes-preserve-unknown-fields</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">description</span>:<span style="color:#bbb"> </span>this<span style="color:#bbb"> </span>is<span style="color:#bbb"> </span>arbitrary<span style="color:#bbb"> </span>JSON</code></pre>
</div>
<p>
  With this only object type values are allowed.
</p>
<p>
  Pruning is enabled again for each specified property (or
  <code>
    additionalProperties
  </code>
  ):
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">json</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">x-kubernetes-preserve-unknown-fields</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">bar</span>:<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string</code></pre>
</div>
<p>
  With this, the value:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">json</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb"> </span>abc<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">bar</span>:<span style="color:#bbb"> </span>def<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">something</span>:<span style="color:#bbb"> </span>x<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">status</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">something</span>:<span style="color:#bbb"> </span>x</code></pre>
</div>
<p>
  is pruned to:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">json</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb"> </span>abc<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">bar</span>:<span style="color:#bbb"> </span>def<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">status</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">something</span>:<span style="color:#bbb"> </span>x</code></pre>
</div>
<p>
  This means that the
  <code>
    something
  </code>
  field in the specified
  <code>
    spec
  </code>
  object is pruned, but everything outside is not.
</p>
<h3 id="intorstring">
  IntOrString
</h3>
<p>
  Nodes in a schema with
  <code>
    x-kubernetes-int-or-string: true
  </code>
  are excluded from rule 1, such that the following is structural:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">x-kubernetes-int-or-string</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span></code></pre>
</div>
<p>
  Also those nodes are partially excluded from rule 3 in the sense that the following two patterns are allowed (exactly those, without variations in order to additional fields):
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">x-kubernetes-int-or-string</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">anyOf</span>:<span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb"></span>...</code></pre>
</div>
<p>
  and
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">x-kubernetes-int-or-string</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">allOf</span>:<span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#a2f;font-weight:bold">anyOf</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- <span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- <span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb"></span>- ...<span style="color:#bbb"> </span><span style="color:#080;font-style:italic"># zero or more</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>...</code></pre>
</div>
<p>
  With one of those specification, both an integer and a string validate.
</p>
<p>
  In
  <a href="/docs/tasks/access-kubernetes-api/extend-api-custom-resource-definitions/#publish-validation-schema-in-openapi-v2">
    Validation Schema Publishing
  </a>
  ,
  <code>
    x-kubernetes-int-or-string: true
  </code>
  is unfolded to one of the two patterns shown above.
</p>
<h3 id="rawextension">
  RawExtension
</h3>
<p>
  RawExtensions (as in
  <code>
    runtime.RawExtension
  </code>
  defined in
  <a href="https://github.com/kubernetes/apimachinery/blob/03ac7a9ade429d715a1a46ceaa3724c18ebae54f/pkg/runtime/types.go#L94">
    k8s.io/apimachinery
  </a>
  ) holds complete Kubernetes objects, i.e. with
  <code>
    apiVersion
  </code>
  and
  <code>
    kind
  </code>
  fields.
</p>
<p>
  It is possible to specify those embedded objects (both completely without constraints or partially specified) by setting
  <code>
    x-kubernetes-embedded-resource: true
  </code>
  . For example:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">x-kubernetes-embedded-resource</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">x-kubernetes-preserve-unknown-fields</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span></code></pre>
</div>
<p>
  Here, the field
  <code>
    foo
  </code>
  holds a complete object, e.g.:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>...</code></pre>
</div>
<p>
  Because
  <code>
    x-kubernetes-preserve-unknown-fields: true
  </code>
  is specified alongside, nothing is pruned. The use of
  <code>
    x-kubernetes-preserve-unknown-fields: true
  </code>
  is optional though.
</p>
<p>
  With
  <code>
    x-kubernetes-embedded-resource: true
  </code>
  , the
  <code>
    apiVersion
  </code>
  ,
  <code>
    kind
  </code>
  and
  <code>
    metadata
  </code>
  are implicitly specified and validated.
</p>
<h2 id="serving-multiple-versions-of-a-crd">
  Serving multiple versions of a CRD
</h2>
<p>
  See
  <a href="/docs/tasks/access-kubernetes-api/custom-resources/custom-resource-definition-versioning/">
    Custom resource definition versioning
  </a>
  for more information about serving multiple versions of your
  CustomResourceDefinition and migrating your objects from one version to another.
</p>
<h2 id="advanced-topics">
  Advanced topics
</h2>
<h3 id="finalizers">
  Finalizers
</h3>
<p>
  <em>
    Finalizers
  </em>
  allow controllers to implement asynchronous pre-delete hooks.
  Custom objects support finalizers just like built-in objects.
</p>
<p>
  You can add a finalizer to a custom object like this:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;stable.example.com/v1&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">finalizers</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- finalizer.stable.example.com</code></pre>
</div>
<p>
  Finalizers are arbitrary string values, that when present ensure that a hard delete
  of a resource is not possible while they exist.
</p>
<p>
  The first delete request on an object with finalizers sets a value for the
  <code>
    metadata.deletionTimestamp
  </code>
  field but does not delete it. Once this value is set,
  entries in the
  <code>
    finalizer
  </code>
  list can only be removed.
</p>
<p>
  When the
  <code>
    metadata.deletionTimestamp
  </code>
  field is set, controllers watching the object
  execute any finalizers they handle, by polling update requests for that
  object. When all finalizers have been executed, the resource is deleted.
</p>
<p>
  The value of
  <code>
    metadata.deletionGracePeriodSeconds
  </code>
  controls the interval between
  polling updates.
</p>
<p>
  It is the responsibility of each controller to remove its finalizer from the list.
</p>
<p>
  Kubernetes only finally deletes the object if the list of finalizers is empty,
  meaning all finalizers have been executed.
</p>
<h3 id="validation">
  Validation
</h3>
<div style="margin-top: 10px; margin-bottom: 10px;">
  <b>
    FEATURE STATE:
  </b>
  <code>
    Kubernetes v1.16
  </code>
  <a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all">
    <span class="ui-icon ui-icon-newwin"></span>
    stable
  </a>
  <div id="feature-state-dialog" class="ui-dialog-content" title="stable">
    <p>
      This feature is
      <em>
        stable
      </em>
      , meaning:
    </p>
    <ul>
      <li>
        The version name is vX where X is an integer.
      </li>
      <li>
        Stable versions of features will appear in released software for many subsequent versions.
      </li>
    </ul>
  </div>
  <script>
    $(function(){

    $( "#feature-state-dialog" ).dialog({
    autoOpen: false,
    width: "600",
    buttons: [
    {
    text: "Ok",
    click: function() {
    $( this ).dialog( "close" );
    }
    }
    ]
    });


    $( "#feature-state-dialog-link" ).click(function( event ) {
    $( "#feature-state-dialog" ).dialog( "open" );
    event.preventDefault();
    });

    });
  </script>
</div>
<p>
  Validation of custom objects is possible via
  <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.0.md#schemaObject">
    OpenAPI v3 schemas
  </a>
  or
  <a href="/docs/reference/access-authn-authz/admission-controllers/#validatingadmissionwebhook">
    validatingadmissionwebhook
  </a>
  . In
  <code>
    apiextensions.k8s.io/v1
  </code>
  schemas are required, in
  <code>
    apiextensions.k8s.io/v1beta1
  </code>
  they are optional.
</p>
<p>
  Additionally, the following restrictions are applied to the schema:
</p>
<ul>
  <li>
    These fields cannot be set:
    <ul>
      <li>
        <code>
          definitions
        </code>
        ,
      </li>
      <li>
        <code>
          dependencies
        </code>
        ,
      </li>
      <li>
        <code>
          deprecated
        </code>
        ,
      </li>
      <li>
        <code>
          discriminator
        </code>
        ,
      </li>
      <li>
        <code>
          id
        </code>
        ,
      </li>
      <li>
        <code>
          patternProperties
        </code>
        ,
      </li>
      <li>
        <code>
          readOnly
        </code>
        ,
      </li>
      <li>
        <code>
          writeOnly
        </code>
        ,
      </li>
      <li>
        <code>
          xml
        </code>
        ,
      </li>
      <li>
        <code>
          $ref
        </code>
        .
      </li>
    </ul>
  </li>
  <li>
    The field
    <code>
      uniqueItems
    </code>
    cannot be set to true.
  </li>
  <li>
    The field
    <code>
      additionalProperties
    </code>
    cannot be set to false.
  </li>
  <li>
    The field
    <code>
      additionalProperties
    </code>
    is mutually exclusive with
    <code>
      properties
    </code>
    .
  </li>
</ul>
<p>
  These fields can only be set with specific features enabled:
</p>
<ul>
  <li>
    <code>
      default
    </code>
    : can be set for
    <code>
      apiextensions.k8s.io/v1
    </code>
    CustomResourceDefinitions. Defaulting is in GA since 1.17 (beta since 1.16 with the
    <code>
      CustomResourceDefaulting
    </code>
    feature gate to be enabled, which is the case automatically for many clusters for beta features). Compare
    <a href="/docs/tasks/access-kubernetes-api/extend-api-custom-resource-definitions/#defaulting">
      Validation Schema Defaulting
    </a>
    .
  </li>
</ul>
<p>
  Note: compare with
  <a href="#specifying-a-structural-schema">
    structural schemas
  </a>
  for further restriction required for certain CustomResourceDefinition features.
</p>
<p>
  The schema is defined in the CustomResourceDefinition. In the following example, the
  CustomResourceDefinition applies the following validations on the custom object:
</p>
<ul>
  <li>
    <code>
      spec.cronSpec
    </code>
    must be a string and must be of the form described by the regular expression.
  </li>
  <li>
    <code>
      spec.replicas
    </code>
    must be an integer and must have a minimum value of 1 and a maximum value of 10.
  </li>
</ul>
<p>
  Save the CustomResourceDefinition to
  <code>
    resourcedefinition.yaml
  </code>
  :
</p>
<div id="customresourcedefinition-validation">
<ul>
  <li>
    <a href="#customresourcedefinition-validation-0">
      apiextensions.k8s.io/v1
    </a>
  </li>
  <li>
    <a href="#customresourcedefinition-validation-1">
      apiextensions.k8s.io/v1beta1
    </a>
  </li>
</ul>
<div id="customresourcedefinition-validation-0">
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>apiextensions.k8s.io/v1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CustomResourceDefinition<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>crontabs.stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">group</span>:<span style="color:#bbb"> </span>stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">versions</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">served</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">storage</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># openAPIV3Schema is the schema for validating custom objects.</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">openAPIV3Schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">pattern</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#39;^(\d+|\*)(/\d+)?(\s+(\d+|\*)(/\d+)?){4}$&#39;</span><span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">minimum</span>:<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">maximum</span>:<span style="color:#bbb"> </span><span style="color:#666">10</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">scope</span>:<span style="color:#bbb"> </span>Namespaced<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">names</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">plural</span>:<span style="color:#bbb"> </span>crontabs<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">singular</span>:<span style="color:#bbb"> </span>crontab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">shortNames</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- ct</code></pre>
  </div>
  <p>
</div>
<div id="customresourcedefinition-validation-1">
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#080;font-style:italic"># Deprecated in v1.16 in favor of apiextensions.k8s.io/v1</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>apiextensions.k8s.io/v1beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CustomResourceDefinition<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>crontabs.stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">group</span>:<span style="color:#bbb"> </span>stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">versions</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">served</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">storage</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">version</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">scope</span>:<span style="color:#bbb"> </span>Namespaced<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">names</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">plural</span>:<span style="color:#bbb"> </span>crontabs<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">singular</span>:<span style="color:#bbb"> </span>crontab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">shortNames</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- ct<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">validation</span>:<span style="color:#bbb">
</span><span style="color:#bbb">   </span><span style="color:#080;font-style:italic"># openAPIV3Schema is the schema for validating custom objects.</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">openAPIV3Schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">pattern</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#39;^(\d+|\*)(/\d+)?(\s+(\d+|\*)(/\d+)?){4}$&#39;</span><span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">minimum</span>:<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">maximum</span>:<span style="color:#bbb"> </span><span style="color:#666">10</span></code></pre>
  </div>
  <p>
</div>
<p>
<script>
  $(function(){$("#customresourcedefinition-validation").tabs();});
</script>
<p>
  And create it:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl apply -f resourcedefinition.yaml</code></pre>
</div>
<p>
  A request to create a custom object of kind
  <code>
    CronTab
  </code>
  will be rejected if there are invalid values in its fields.
  In the following example, the custom object contains fields with invalid values:
</p>
<ul>
  <li>
    <code>
      spec.cronSpec
    </code>
    does not match the regular expression.
  </li>
  <li>
    <code>
      spec.replicas
    </code>
    is greater than 10.
  </li>
</ul>
<p>
  If you save the following YAML to
  <code>
    my-crontab.yaml
  </code>
  :
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;stable.example.com/v1&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>my-new-cron-object<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;* * * *&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>my-awesome-cron-image<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb"> </span><span style="color:#666">15</span></code></pre>
</div>
<p>
  and create it:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl apply -f my-crontab.yaml</code></pre>
</div>
<p>
  you will get an error:
</p><pre><code class="language-console" data-lang="console">The CronTab &#34;my-new-cron-object&#34; is invalid: []: Invalid value: map[string]interface {}{&#34;apiVersion&#34;:&#34;stable.example.com/v1&#34;, &#34;kind&#34;:&#34;CronTab&#34;, &#34;metadata&#34;:map[string]interface {}{&#34;name&#34;:&#34;my-new-cron-object&#34;, &#34;namespace&#34;:&#34;default&#34;, &#34;deletionTimestamp&#34;:interface {}(nil), &#34;deletionGracePeriodSeconds&#34;:(*int64)(nil), &#34;creationTimestamp&#34;:&#34;2017-09-05T05:20:07Z&#34;, &#34;uid&#34;:&#34;e14d79e7-91f9-11e7-a598-f0761cb232d1&#34;, &#34;clusterName&#34;:&#34;&#34;}, &#34;spec&#34;:map[string]interface {}{&#34;cronSpec&#34;:&#34;* * * *&#34;, &#34;image&#34;:&#34;my-awesome-cron-image&#34;, &#34;replicas&#34;:15}}:
validation failure list:
spec.cronSpec in body should match &#39;^(\d+|\*)(/\d+)?(\s+(\d+|\*)(/\d+)?){4}$&#39;
spec.replicas in body should be less than or equal to 10</code></pre>
<p>
  If the fields contain valid values, the object creation request is accepted.
</p>
<p>
  Save the following YAML to
  <code>
    my-crontab.yaml
  </code>
  :
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;stable.example.com/v1&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>my-new-cron-object<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;* * * * */5&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>my-awesome-cron-image<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb"> </span><span style="color:#666">5</span></code></pre>
</div>
<p>
  And create it:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl apply -f my-crontab.yaml
crontab <span style="color:#b44">&#34;my-new-cron-object&#34;</span> created</code></pre>
</div>
<h3 id="defaulting">
  Defaulting
</h3>
<div style="margin-top: 10px; margin-bottom: 10px;">
  <b>
    FEATURE STATE:
  </b>
  <code>
    Kubernetes v1.17
  </code>
  <a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all">
    <span class="ui-icon ui-icon-newwin"></span>
    stable
  </a>
  <div id="feature-state-dialog" class="ui-dialog-content" title="stable">
    <p>
      This feature is
      <em>
        stable
      </em>
      , meaning:
    </p>
    <ul>
      <li>
        The version name is vX where X is an integer.
      </li>
      <li>
        Stable versions of features will appear in released software for many subsequent versions.
      </li>
    </ul>
  </div>
  <script>
    $(function(){

    $( "#feature-state-dialog" ).dialog({
    autoOpen: false,
    width: "600",
    buttons: [
    {
    text: "Ok",
    click: function() {
    $( this ).dialog( "close" );
    }
    }
    ]
    });


    $( "#feature-state-dialog-link" ).click(function( event ) {
    $( "#feature-state-dialog" ).dialog( "open" );
    event.preventDefault();
    });

    });
  </script>
</div>
<blockquote class="note">
  <div>
    <strong>
      Note:
    </strong>
    To use defaulting, your CustomResourceDefinition must use API version
    <code>
      apiextensions.k8s.io/v1
    </code>
    .
  </div>
</blockquote>
<p>
  Defaulting allows to specify default values in the
  <a href="#validation">
    OpenAPI v3 validation schema
  </a>
  :
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>apiextensions.k8s.io/v1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CustomResourceDefinition<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>crontabs.stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">group</span>:<span style="color:#bbb"> </span>stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">versions</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">served</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">storage</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># openAPIV3Schema is the schema for validating custom objects.</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">openAPIV3Schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">pattern</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#39;^(\d+|\*)(/\d+)?(\s+(\d+|\*)(/\d+)?){4}$&#39;</span><span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">default</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;5 0 * * *&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">minimum</span>:<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">maximum</span>:<span style="color:#bbb"> </span><span style="color:#666">10</span><span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">default</span>:<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">scope</span>:<span style="color:#bbb"> </span>Namespaced<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">names</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">plural</span>:<span style="color:#bbb"> </span>crontabs<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">singular</span>:<span style="color:#bbb"> </span>crontab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">shortNames</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- ct</code></pre>
</div>
<p>
  With this both
  <code>
    cronSpec
  </code>
  and
  <code>
    replicas
  </code>
  are defaulted:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;stable.example.com/v1&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>my-new-cron-object<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>my-awesome-cron-image</code></pre>
</div>
<p>
  leads to
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;stable.example.com/v1&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>my-new-cron-object<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;5 0 * * *&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>my-awesome-cron-image<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb"> </span><span style="color:#666">1</span></code></pre>
</div>
<p>
  Note that defaulting happens on the object
</p>
<ul>
  <li>
    in the request to the API server using the request version defaults,
  </li>
  <li>
    when reading from etcd using the storage version defaults,
  </li>
  <li>
    after mutating admission plugins with non-empty patches using the admission webhook object version defaults.
  </li>
</ul>
<p>
  Defaults applied when reading data from etcd are not automatically written back to etcd. An update request via the API is required to persist those defaults back into etcd.
</p>
<p>
  Default values must be pruned (with the exception of defaults for
  <code>
    metadata
  </code>
  fields) and must validate against a provided schema.
</p>
<p>
  Default values for
  <code>
    metadata
  </code>
  fields of
  <code>
    x-kubernetes-embedded-resources: true
  </code>
  nodes (or parts of a default value covering
  <code>
    metadata
  </code>
  ) are not pruned during CustomResourceDefinition creation, but through the pruning step during handling of requests.
</p>
<h3 id="publish-validation-schema-in-openapi-v2">
  Publish Validation Schema in OpenAPI v2
</h3>
<div style="margin-top: 10px; margin-bottom: 10px;">
  <b>
    FEATURE STATE:
  </b>
  <code>
    Kubernetes v1.16
  </code>
  <a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all">
    <span class="ui-icon ui-icon-newwin"></span>
    stable
  </a>
  <div id="feature-state-dialog" class="ui-dialog-content" title="stable">
    <p>
      This feature is
      <em>
        stable
      </em>
      , meaning:
    </p>
    <ul>
      <li>
        The version name is vX where X is an integer.
      </li>
      <li>
        Stable versions of features will appear in released software for many subsequent versions.
      </li>
    </ul>
  </div>
  <script>
    $(function(){

    $( "#feature-state-dialog" ).dialog({
    autoOpen: false,
    width: "600",
    buttons: [
    {
    text: "Ok",
    click: function() {
    $( this ).dialog( "close" );
    }
    }
    ]
    });


    $( "#feature-state-dialog-link" ).click(function( event ) {
    $( "#feature-state-dialog" ).dialog( "open" );
    event.preventDefault();
    });

    });
  </script>
</div>
<blockquote class="note">
  <div>
    <strong>
      Note:
    </strong>
    OpenAPI v2 Publishing is available as beta since 1.15, and as alpha since 1.14. The
    <code>
      CustomResourcePublishOpenAPI
    </code>
    feature must be enabled, which is the case automatically for many clusters for beta features. Please refer to the
    <a href="/docs/reference/command-line-tools-reference/feature-gates/">
      feature gate
    </a>
    documentation for more information.
  </div>
</blockquote>
<p>
  With the OpenAPI v2 Publishing feature enabled, CustomResourceDefinition
  <a href="#validation">
    OpenAPI v3 validation schemas
  </a>
  which are
  <a href="#specifying-a-structural-schema">
    structural
  </a>
  and
  <a href="#preserving-unknown-fields">
    enable pruning
  </a>
  (opt-in in v1beta1, enabled by default in v1) are published as part of the
  <a href="/docs/concepts/overview/kubernetes-api/#openapi-and-swagger-definitions">
    OpenAPI v2 spec
  </a>
  from Kubernetes API server.
</p>
<p>
  <a href="/docs/reference/kubectl/overview">
    kubectl
  </a>
  consumes the published schema to perform client-side validation (
  <code>
    kubectl create
  </code>
  and
  <code>
    kubectl apply
  </code>
  ), schema explanation (
  <code>
    kubectl explain
  </code>
  ) on custom resources. The published schema can be consumed for other purposes as well, like client generation or documentation.
</p>
<p>
  The OpenAPI v3 validation schema is converted to OpenAPI v2 schema, and
  show up in
  <code>
    definitions
  </code>
  and
  <code>
    paths
  </code>
  fields in the
  <a href="/docs/concepts/overview/kubernetes-api/#openapi-and-swagger-definitions">
    OpenAPI v2 spec
  </a>
  .
  The following modifications are applied during the conversion to keep backwards compatibility with
  kubectl in previous 1.13 version. These modifications prevent kubectl from being over-strict and rejecting
  valid OpenAPI schemas that it doesn&rsquo;t understand. The conversion won&rsquo;t modify the validation schema defined in CRD,
  and therefore won&rsquo;t affect
  <a href="#validation">
    validation
  </a>
  in the API server.
</p>
<ol>
  <li>
    The following fields are removed as they aren&rsquo;t supported by OpenAPI v2 (in future versions OpenAPI v3 will be used without these restrictions)
    <ul>
      <li>
        The fields
        <code>
          allOf
        </code>
        ,
        <code>
          anyOf
        </code>
        ,
        <code>
          oneOf
        </code>
        and
        <code>
          not
        </code>
        are removed
      </li>
    </ul>
  </li>
  <li>
    If
    <code>
      nullable: true
    </code>
    is set, we drop
    <code>
      type
    </code>
    ,
    <code>
      nullable
    </code>
    ,
    <code>
      items
    </code>
    and
    <code>
      properties
    </code>
    because OpenAPI v2 is not able to express nullable. To avoid kubectl to reject good objects, this is necessary.
  </li>
</ol>
<h3 id="additional-printer-columns">
  Additional printer columns
</h3>
<p>
  Starting with Kubernetes 1.11, kubectl uses server-side printing. The server decides which
  columns are shown by the
  <code>
    kubectl get
  </code>
  command. You can customize these columns using a
  CustomResourceDefinition. The following example adds the
  <code>
    Spec
  </code>
  ,
  <code>
    Replicas
  </code>
  , and
  <code>
    Age
  </code>
  columns.
</p>
<ol>
  <li>
    Save the CustomResourceDefinition to
    <code>
      resourcedefinition.yaml
    </code>
    .
    <br />
  </li>
</ol>
<div id="customresourcedefinition-printer-columns">
<ul>
  <li>
    <a href="#customresourcedefinition-printer-columns-0">
      apiextensions.k8s.io/v1
    </a>
  </li>
  <li>
    <a href="#customresourcedefinition-printer-columns-1">
      apiextensions.k8s.io/v1beta1
    </a>
  </li>
</ul>
<div id="customresourcedefinition-printer-columns-0">
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>apiextensions.k8s.io/v1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CustomResourceDefinition<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>crontabs.stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">group</span>:<span style="color:#bbb"> </span>stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">scope</span>:<span style="color:#bbb"> </span>Namespaced<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">names</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">plural</span>:<span style="color:#bbb"> </span>crontabs<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">singular</span>:<span style="color:#bbb"> </span>crontab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">shortNames</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- ct<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">versions</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">served</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">storage</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">openAPIV3Schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">additionalPrinterColumns</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>Spec<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">description</span>:<span style="color:#bbb"> </span>The<span style="color:#bbb"> </span>cron<span style="color:#bbb"> </span>spec<span style="color:#bbb"> </span>defining<span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>interval<span style="color:#bbb"> </span>a<span style="color:#bbb"> </span>CronJob<span style="color:#bbb"> </span>is<span style="color:#bbb"> </span>run<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">jsonPath</span>:<span style="color:#bbb"> </span>.spec.cronSpec<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>Replicas<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">description</span>:<span style="color:#bbb"> </span>The<span style="color:#bbb"> </span>number<span style="color:#bbb"> </span>of<span style="color:#bbb"> </span>jobs<span style="color:#bbb"> </span>launched<span style="color:#bbb"> </span>by<span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>CronJob<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">jsonPath</span>:<span style="color:#bbb"> </span>.spec.replicas<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>Age<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>date<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">jsonPath</span>:<span style="color:#bbb"> </span>.metadata.creationTimestamp</code></pre>
  </div>
  <p>
</div>
<div id="customresourcedefinition-printer-columns-1">
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#080;font-style:italic"># Deprecated in v1.16 in favor of apiextensions.k8s.io/v1</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>apiextensions.k8s.io/v1beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CustomResourceDefinition<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>crontabs.stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">group</span>:<span style="color:#bbb"> </span>stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">version</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">scope</span>:<span style="color:#bbb"> </span>Namespaced<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">names</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">plural</span>:<span style="color:#bbb"> </span>crontabs<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">singular</span>:<span style="color:#bbb"> </span>crontab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">shortNames</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- ct<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">validation</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">openAPIV3Schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">additionalPrinterColumns</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>Spec<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">description</span>:<span style="color:#bbb"> </span>The<span style="color:#bbb"> </span>cron<span style="color:#bbb"> </span>spec<span style="color:#bbb"> </span>defining<span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>interval<span style="color:#bbb"> </span>a<span style="color:#bbb"> </span>CronJob<span style="color:#bbb"> </span>is<span style="color:#bbb"> </span>run<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">JSONPath</span>:<span style="color:#bbb"> </span>.spec.cronSpec<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>Replicas<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">description</span>:<span style="color:#bbb"> </span>The<span style="color:#bbb"> </span>number<span style="color:#bbb"> </span>of<span style="color:#bbb"> </span>jobs<span style="color:#bbb"> </span>launched<span style="color:#bbb"> </span>by<span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>CronJob<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">JSONPath</span>:<span style="color:#bbb"> </span>.spec.replicas<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>Age<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>date<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">JSONPath</span>:<span style="color:#bbb"> </span>.metadata.creationTimestamp</code></pre>
  </div>
  <p>
</div>
<p>
<script>
  $(function(){$("#customresourcedefinition-printer-columns").tabs();});
</script>
<ol>
  <li>
    <p>
      Create the CustomResourceDefinition:
    </p>
    <div class="highlight">
      <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">  kubectl apply -f resourcedefinition.yaml</code></pre>
    </div>
  </li>
  <li>
    <p>
      Create an instance using the
      <code>
        my-crontab.yaml
      </code>
      from the previous section.
    </p>
  </li>
  <li>
    <p>
      Invoke the server-side printing:
    </p>
    <div class="highlight">
      <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">  kubectl get crontab my-new-cron-object</code></pre>
    </div>
    <p>
      Notice the
      <code>
        NAME
      </code>
      ,
      <code>
        SPEC
      </code>
      ,
      <code>
        REPLICAS
      </code>
      , and
      <code>
        AGE
      </code>
      columns in the output:
    </p>
    <pre><code>  NAME                 SPEC        REPLICAS   AGE
  my-new-cron-object   * * * * *   1          7s</code></pre>
  </li>
</ol>
<p>
  The
  <code>
    NAME
  </code>
  column is implicit and does not need to be defined in the CustomResourceDefinition.
</p>
<h4 id="priority">
  Priority
</h4>
<p>
  Each column includes a
  <code>
    priority
  </code>
  field for each column. Currently, the priority
  differentiates between columns shown in standard view or wide view (using the
  <code>
    -o wide
  </code>
  flag).
</p>
<ul>
  <li>
    Columns with priority
    <code>
      0
    </code>
    are shown in standard view.
  </li>
  <li>
    Columns with priority greater than
    <code>
      0
    </code>
    are shown only in wide view.
  </li>
</ul>
<h4 id="type">
  Type
</h4>
<p>
  A column&rsquo;s
  <code>
    type
  </code>
  field can be any of the following (compare
  <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.0.md#dataTypes">
    OpenAPI v3 data types
  </a>
  ):
</p>
<ul>
  <li>
    <code>
      integer
    </code>
     non-floating-point numbers
  </li>
  <li>
    <code>
      number
    </code>
     floating point numbers
  </li>
  <li>
    <code>
      string
    </code>
     strings
  </li>
  <li>
    <code>
      boolean
    </code>
     true or false
  </li>
  <li>
    <code>
      date
    </code>
     rendered differentially as time since this timestamp.
  </li>
</ul>
<p>
  If the value inside a CustomResource does not match the type specified for the column,
  the value is omitted. Use CustomResource validation to ensure that the value
  types are correct.
</p>
<h4 id="format">
  Format
</h4>
<p>
  A column&rsquo;s
  <code>
    format
  </code>
  field can be any of the following:
</p>
<ul>
  <li>
    <code>
      int32
    </code>
  </li>
  <li>
    <code>
      int64
    </code>
  </li>
  <li>
    <code>
      float
    </code>
  </li>
  <li>
    <code>
      double
    </code>
  </li>
  <li>
    <code>
      byte
    </code>
  </li>
  <li>
    <code>
      date
    </code>
  </li>
  <li>
    <code>
      date-time
    </code>
  </li>
  <li>
    <code>
      password
    </code>
  </li>
</ul>
<p>
  The column&rsquo;s
  <code>
    format
  </code>
  controls the style used when
  <code>
    kubectl
  </code>
  prints the value.
</p>
<h3 id="subresources">
  Subresources
</h3>
<div style="margin-top: 10px; margin-bottom: 10px;">
  <b>
    FEATURE STATE:
  </b>
  <code>
    Kubernetes v1.16
  </code>
  <a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all">
    <span class="ui-icon ui-icon-newwin"></span>
    stable
  </a>
  <div id="feature-state-dialog" class="ui-dialog-content" title="stable">
    <p>
      This feature is
      <em>
        stable
      </em>
      , meaning:
    </p>
    <ul>
      <li>
        The version name is vX where X is an integer.
      </li>
      <li>
        Stable versions of features will appear in released software for many subsequent versions.
      </li>
    </ul>
  </div>
  <script>
    $(function(){

    $( "#feature-state-dialog" ).dialog({
    autoOpen: false,
    width: "600",
    buttons: [
    {
    text: "Ok",
    click: function() {
    $( this ).dialog( "close" );
    }
    }
    ]
    });


    $( "#feature-state-dialog-link" ).click(function( event ) {
    $( "#feature-state-dialog" ).dialog( "open" );
    event.preventDefault();
    });

    });
  </script>
</div>
<p>
  Custom resources support
  <code>
    /status
  </code>
  and
  <code>
    /scale
  </code>
  subresources.
</p>
<p>
  You can disable this feature using the
  <code>
    CustomResourceSubresources
  </code>
  feature gate on
  the
  <a href="/docs/admin/kube-apiserver">
    kube-apiserver
  </a>
  :
</p><pre><code>--feature-gates=CustomResourceSubresources=false</code></pre>
<p>
  The status and scale subresources can be optionally enabled by
  defining them in the CustomResourceDefinition.
</p>
<h4 id="status-subresource">
  Status subresource
</h4>
<p>
  When the status subresource is enabled, the
  <code>
    /status
  </code>
  subresource for the custom resource is exposed.
</p>
<ul>
  <li>
    The status and the spec stanzas are represented by the
    <code>
      .status
    </code>
    and
    <code>
      .spec
    </code>
    JSONPaths respectively inside of a custom resource.
  </li>
  <li>
    <code>
      PUT
    </code>
    requests to the
    <code>
      /status
    </code>
    subresource take a custom resource object and ignore changes to anything except the status stanza.
  </li>
  <li>
    <code>
      PUT
    </code>
    requests to the
    <code>
      /status
    </code>
    subresource only validate the status stanza of the custom resource.
  </li>
  <li>
    <code>
      PUT
    </code>
    /
    <code>
      POST
    </code>
    /
    <code>
      PATCH
    </code>
    requests to the custom resource ignore changes to the status stanza.
  </li>
  <li>
    The
    <code>
      .metadata.generation
    </code>
    value is incremented for all changes, except for changes to
    <code>
      .metadata
    </code>
    or
    <code>
      .status
    </code>
    .
  </li>
  <li>
    <p>
      Only the following constructs are allowed at the root of the CRD OpenAPI validation schema:
    </p>
    <ul>
      <li>
        Description
      </li>
      <li>
        Example
      </li>
      <li>
        ExclusiveMaximum
      </li>
      <li>
        ExclusiveMinimum
      </li>
      <li>
        ExternalDocs
      </li>
      <li>
        Format
      </li>
      <li>
        Items
      </li>
      <li>
        Maximum
      </li>
      <li>
        MaxItems
      </li>
      <li>
        MaxLength
      </li>
      <li>
        Minimum
      </li>
      <li>
        MinItems
      </li>
      <li>
        MinLength
      </li>
      <li>
        MultipleOf
      </li>
      <li>
        Pattern
      </li>
      <li>
        Properties
      </li>
      <li>
        Required
      </li>
      <li>
        Title
      </li>
      <li>
        Type
      </li>
      <li>
        UniqueItems
      </li>
    </ul>
  </li>
</ul>
<h4 id="scale-subresource">
  Scale subresource
</h4>
<p>
  When the scale subresource is enabled, the
  <code>
    /scale
  </code>
  subresource for the custom resource is exposed.
  The
  <code>
    autoscaling/v1.Scale
  </code>
  object is sent as the payload for
  <code>
    /scale
  </code>
  .
</p>
<p>
  To enable the scale subresource, the following values are defined in the CustomResourceDefinition.
</p>
<ul>
  <li>
    <p>
      <code>
        SpecReplicasPath
      </code>
      defines the JSONPath inside of a custom resource that corresponds to
      <code>
        Scale.Spec.Replicas
      </code>
      .
    </p>
    <ul>
      <li>
        It is a required value.
      </li>
      <li>
        Only JSONPaths under
        <code>
          .spec
        </code>
        and with the dot notation are allowed.
      </li>
      <li>
        If there is no value under the
        <code>
          SpecReplicasPath
        </code>
        in the custom resource,
        the
        <code>
          /scale
        </code>
        subresource will return an error on GET.
      </li>
    </ul>
  </li>
  <li>
    <p>
      <code>
        StatusReplicasPath
      </code>
      defines the JSONPath inside of a custom resource that corresponds to
      <code>
        Scale.Status.Replicas
      </code>
      .
    </p>
    <ul>
      <li>
        It is a required value.
      </li>
      <li>
        Only JSONPaths under
        <code>
          .status
        </code>
        and with the dot notation are allowed.
      </li>
      <li>
        If there is no value under the
        <code>
          StatusReplicasPath
        </code>
        in the custom resource,
        the status replica value in the
        <code>
          /scale
        </code>
        subresource will default to 0.
      </li>
    </ul>
  </li>
  <li>
    <p>
      <code>
        LabelSelectorPath
      </code>
      defines the JSONPath inside of a custom resource that corresponds to
      <code>
        Scale.Status.Selector
      </code>
      .
    </p>
    <ul>
      <li>
        It is an optional value.
      </li>
      <li>
        It must be set to work with HPA.
      </li>
      <li>
        Only JSONPaths under
        <code>
          .status
        </code>
        or
        <code>
          .spec
        </code>
        and with the dot notation are allowed.
      </li>
      <li>
        If there is no value under the
        <code>
          LabelSelectorPath
        </code>
        in the custom resource,
        the status selector value in the
        <code>
          /scale
        </code>
        subresource will default to the empty string.
      </li>
      <li>
        The field pointed by this JSON path must be a string field (not a complex selector struct) which contains a serialized label selector in string form.
      </li>
    </ul>
  </li>
</ul>
<p>
  In the following example, both status and scale subresources are enabled.
</p>
<p>
  Save the CustomResourceDefinition to
  <code>
    resourcedefinition.yaml
  </code>
  :
</p>
<div id="customresourcedefinition-scale">
<ul>
  <li>
    <a href="#customresourcedefinition-scale-0">
      apiextensions.k8s.io/v1
    </a>
  </li>
  <li>
    <a href="#customresourcedefinition-scale-1">
      apiextensions.k8s.io/v1beta1
    </a>
  </li>
</ul>
<div id="customresourcedefinition-scale-0">
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>apiextensions.k8s.io/v1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CustomResourceDefinition<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>crontabs.stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">group</span>:<span style="color:#bbb"> </span>stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">versions</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">served</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">storage</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">openAPIV3Schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">status</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">labelSelector</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#080;font-style:italic"># subresources describes the subresources for custom resources.</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">subresources</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># status enables the status subresource.</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">status</span>:<span style="color:#bbb"> </span>{}<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># scale enables the scale subresource.</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">scale</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#080;font-style:italic"># specReplicasPath defines the JSONPath inside of a custom resource that corresponds to Scale.Spec.Replicas.</span><span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">specReplicasPath</span>:<span style="color:#bbb"> </span>.spec.replicas<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#080;font-style:italic"># statusReplicasPath defines the JSONPath inside of a custom resource that corresponds to Scale.Status.Replicas.</span><span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">statusReplicasPath</span>:<span style="color:#bbb"> </span>.status.replicas<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#080;font-style:italic"># labelSelectorPath defines the JSONPath inside of a custom resource that corresponds to Scale.Status.Selector.</span><span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">labelSelectorPath</span>:<span style="color:#bbb"> </span>.status.labelSelector<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">scope</span>:<span style="color:#bbb"> </span>Namespaced<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">names</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">plural</span>:<span style="color:#bbb"> </span>crontabs<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">singular</span>:<span style="color:#bbb"> </span>crontab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">shortNames</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- ct</code></pre>
  </div>
  <p>
</div>
<div id="customresourcedefinition-scale-1">
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#080;font-style:italic"># Deprecated in v1.16 in favor of apiextensions.k8s.io/v1</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>apiextensions.k8s.io/v1beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CustomResourceDefinition<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>crontabs.stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">group</span>:<span style="color:#bbb"> </span>stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">versions</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">served</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">storage</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">scope</span>:<span style="color:#bbb"> </span>Namespaced<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">names</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">plural</span>:<span style="color:#bbb"> </span>crontabs<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">singular</span>:<span style="color:#bbb"> </span>crontab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">shortNames</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- ct<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">validation</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">openAPIV3Schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">status</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">labelSelector</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#080;font-style:italic"># subresources describes the subresources for custom resources.</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">subresources</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic"># status enables the status subresource.</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">status</span>:<span style="color:#bbb"> </span>{}<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic"># scale enables the scale subresource.</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">scale</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#080;font-style:italic"># specReplicasPath defines the JSONPath inside of a custom resource that corresponds to Scale.Spec.Replicas.</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">specReplicasPath</span>:<span style="color:#bbb"> </span>.spec.replicas<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#080;font-style:italic"># statusReplicasPath defines the JSONPath inside of a custom resource that corresponds to Scale.Status.Replicas.</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">statusReplicasPath</span>:<span style="color:#bbb"> </span>.status.replicas<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#080;font-style:italic"># labelSelectorPath defines the JSONPath inside of a custom resource that corresponds to Scale.Status.Selector.</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">labelSelectorPath</span>:<span style="color:#bbb"> </span>.status.labelSelector</code></pre>
  </div>
  <p>
</div>
<p>
<script>
  $(function(){$("#customresourcedefinition-scale").tabs();});
</script>
<p>
  And create it:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl apply -f resourcedefinition.yaml</code></pre>
</div>
<p>
  After the CustomResourceDefinition object has been created, you can create custom objects.
</p>
<p>
  If you save the following YAML to
  <code>
    my-crontab.yaml
  </code>
  :
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;stable.example.com/v1&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>my-new-cron-object<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;* * * * */5&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>my-awesome-cron-image<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb"> </span><span style="color:#666">3</span></code></pre>
</div>
<p>
  and create it:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl apply -f my-crontab.yaml</code></pre>
</div>
<p>
  Then new namespaced RESTful API endpoints are created at:
</p><pre><code>/apis/stable.example.com/v1/namespaces/*/crontabs/status</code></pre>
<p>
  and
</p><pre><code>/apis/stable.example.com/v1/namespaces/*/crontabs/scale</code></pre>
<p>
  A custom resource can be scaled using the
  <code>
    kubectl scale
  </code>
  command.
  For example, the following command sets
  <code>
    .spec.replicas
  </code>
  of the
  custom resource created above to 5:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl scale --replicas<span style="color:#666">=</span><span style="color:#666">5</span> crontabs/my-new-cron-object
crontabs <span style="color:#b44">&#34;my-new-cron-object&#34;</span> scaled

kubectl get crontabs my-new-cron-object -o <span style="color:#b8860b">jsonpath</span><span style="color:#666">=</span><span style="color:#b44">&#39;{.spec.replicas}&#39;</span>
<span style="color:#666">5</span></code></pre>
</div>
<p>
  You can use a
  <a href="/docs/tasks/run-application/configure-pdb/">
    PodDisruptionBudget
  </a>
  to protect custom resources that have the scale subresource enabled.
</p>
<h3 id="categories">
  Categories
</h3>
<p>
  Categories is a list of grouped resources the custom resource belongs to (eg.
  <code>
    all
  </code>
  ).
  You can use
  <code>
    kubectl get &lt;category-name&gt;
  </code>
  to list the resources belonging to the category.
  This feature is
  <strong>
    beta
  </strong>
  and available for custom resources from v1.10.
</p>
<p>
  The following example adds
  <code>
    all
  </code>
  in the list of categories in the CustomResourceDefinition
  and illustrates how to output the custom resource using
  <code>
    kubectl get all
  </code>
  .
</p>
<p>
  Save the following CustomResourceDefinition to
  <code>
    resourcedefinition.yaml
  </code>
  :
</p>
<div id="customresourcedefinition-categories">
<ul>
  <li>
    <a href="#customresourcedefinition-categories-0">
      apiextensions.k8s.io/v1
    </a>
  </li>
  <li>
    <a href="#customresourcedefinition-categories-1">
      apiextensions.k8s.io/v1beta1
    </a>
  </li>
</ul>
<div id="customresourcedefinition-categories-0">
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>apiextensions.k8s.io/v1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CustomResourceDefinition<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>crontabs.stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">group</span>:<span style="color:#bbb"> </span>stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">versions</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">served</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">storage</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">openAPIV3Schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb">
</span><span style="color:#bbb">                  </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">scope</span>:<span style="color:#bbb"> </span>Namespaced<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">names</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">plural</span>:<span style="color:#bbb"> </span>crontabs<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">singular</span>:<span style="color:#bbb"> </span>crontab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">shortNames</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- ct<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic"># categories is a list of grouped resources the custom resource belongs to.</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">categories</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- all</code></pre>
  </div>
  <p>
</div>
<div id="customresourcedefinition-categories-1">
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#080;font-style:italic"># Deprecated in v1.16 in favor of apiextensions.k8s.io/v1</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>apiextensions.k8s.io/v1beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CustomResourceDefinition<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>crontabs.stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">group</span>:<span style="color:#bbb"> </span>stable.example.com<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">versions</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">served</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">storage</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">validation</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">openAPIV3Schema</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>object<span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#a2f;font-weight:bold">properties</span>:<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>string<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">replicas</span>:<span style="color:#bbb">
</span><span style="color:#bbb">              </span><span style="color:#a2f;font-weight:bold">type</span>:<span style="color:#bbb"> </span>integer<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">scope</span>:<span style="color:#bbb"> </span>Namespaced<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">names</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">plural</span>:<span style="color:#bbb"> </span>crontabs<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">singular</span>:<span style="color:#bbb"> </span>crontab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">shortNames</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- ct<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic"># categories is a list of grouped resources the custom resource belongs to.</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">categories</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- all</code></pre>
  </div>
  <p>
</div>
<p>
<script>
  $(function(){$("#customresourcedefinition-categories").tabs();});
</script>
<p>
  And create it:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl apply -f resourcedefinition.yaml</code></pre>
</div>
<p>
  After the CustomResourceDefinition object has been created, you can create custom objects.
</p>
<p>
  Save the following YAML to
  <code>
    my-crontab.yaml
  </code>
  :
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;stable.example.com/v1&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">name</span>:<span style="color:#bbb"> </span>my-new-cron-object<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">cronSpec</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;* * * * */5&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>my-awesome-cron-image</code></pre>
</div>
<p>
  and create it:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl apply -f my-crontab.yaml</code></pre>
</div>
<p>
  You can specify the category using
  <code>
    kubectl get
  </code>
  :
</p><pre><code>kubectl get all</code></pre>
<p>
  and it will include the custom resources of kind
  <code>
    CronTab
  </code>
  :
</p><pre><code class="language-console" data-lang="console">NAME                          AGE
crontabs/my-new-cron-object   3s</code></pre>
<h2 id="what-s-next">
  What&#39;s next
</h2>
<ul>
  <li>
    <p>
      See
      <a href="/docs/reference/generated/kubernetes-api/v1.18/#customresourcedefinition-v1-apiextensions-k8s-io">
        CustomResourceDefinition
      </a>
      .
    </p>
  </li>
  <li>
    <p>
      Serve
      <a href="/docs/tasks/access-kubernetes-api/custom-resources/custom-resource-definition-versioning/">
        multiple versions
      </a>
      of a
      CustomResourceDefinition.
    </p>
  </li>
</ul>
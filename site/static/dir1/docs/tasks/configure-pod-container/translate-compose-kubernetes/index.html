<html>
<body>
<h1>
  Translate a Docker Compose File to Kubernetes Resources
</h1>
<p>
  <a href="https://github.com/kubernetes/website/edit/master/content/en/docs/tasks/configure-pod-container/translate-compose-kubernetes.md" id="editPageButton" target="_blank">
    Edit This Page
  </a>
</p>
<h1>
  Translate a Docker Compose File to Kubernetes Resources
</h1>
<p>
  What&rsquo;s Kompose? It&rsquo;s a conversion tool for all things compose (namely Docker Compose) to container orchestrators (Kubernetes or OpenShift).
</p>
<p>
  More information can be found on the Kompose website at
  <a href="http://kompose.io">
    http://kompose.io
  </a>
  .
</p>
<ul id="markdown-toc">
  <li>
    <a href="#before-you-begin">
      Before you begin
    </a>
  </li>
  <li>
    <a href="#install-kompose">
      Install Kompose
    </a>
  </li>
  <li>
    <a href="#use-kompose">
      Use Kompose
    </a>
  </li>
  <li>
    <a href="#user-guide">
      User Guide
    </a>
  </li>
  <li>
    <a href="#kompose-convert">
      <code>
        kompose convert
      </code>
    </a>
  </li>
  <li>
    <a href="#kompose-up">
      <code>
        kompose up
      </code>
    </a>
  </li>
  <li>
    <a href="#kompose-down">
      <code>
        kompose down
      </code>
    </a>
  </li>
  <li>
    <a href="#build-and-push-docker-images">
      Build and Push Docker Images
    </a>
  </li>
  <li>
    <a href="#alternative-conversions">
      Alternative Conversions
    </a>
  </li>
  <li>
    <a href="#labels">
      Labels
    </a>
  </li>
  <li>
    <a href="#restart">
      Restart
    </a>
  </li>
  <li>
    <a href="#docker-compose-versions">
      Docker Compose Versions
    </a>
  </li>
</ul>
<h2 id="before-you-begin">
  Before you begin
</h2>
<p>
  You need to have a Kubernetes cluster, and the kubectl command-line tool must
  be configured to communicate with your cluster. If you do not already have a
  cluster, you can create one by using
  <a href="/docs/setup/learning-environment/minikube/">
    Minikube
  </a>
  ,
  or you can use one of these Kubernetes playgrounds:
</p>
<ul>
  <li>
    <a href="https://www.katacoda.com/courses/kubernetes/playground">
      Katacoda
    </a>
  </li>
  <li>
    <a href="http://labs.play-with-k8s.com/">
      Play with Kubernetes
    </a>
  </li>
</ul>
<p>
  To check the version, enter
  <code>
    kubectl version
  </code>
  .
</p>
<h2 id="install-kompose">
  Install Kompose
</h2>
<p>
  We have multiple ways to install Kompose. Our preferred method is downloading the binary from the latest GitHub release.
</p>
<div id="install-ways">
<ul>
  <li>
    <a href="#install-ways-0">
      GitHub download
    </a>
  </li>
  <li>
    <a href="#install-ways-1">
      Build from source
    </a>
  </li>
  <li>
    <a href="#install-ways-2">
      CentOS package
    </a>
  </li>
  <li>
    <a href="#install-ways-3">
      Fedora package
    </a>
  </li>
  <li>
    <a href="#install-ways-4">
      Homebrew (macOS)
    </a>
  </li>
</ul>
<div id="install-ways-0">
  <p>
    Kompose is released via GitHub on a three-week cycle, you can see all current releases on the
    <a href="https://github.com/kubernetes/kompose/releases">
      GitHub release page
    </a>
    .
  </p>
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#080;font-style:italic"># Linux</span>
curl -L https://github.com/kubernetes/kompose/releases/download/v1.21.0/kompose-linux-amd64 -o kompose

<span style="color:#080;font-style:italic"># macOS</span>
curl -L https://github.com/kubernetes/kompose/releases/download/v1.21.0/kompose-darwin-amd64 -o kompose

<span style="color:#080;font-style:italic"># Windows</span>
curl -L https://github.com/kubernetes/kompose/releases/download/v1.21.0/kompose-windows-amd64.exe -o kompose.exe

chmod +x kompose
sudo mv ./kompose /usr/local/bin/kompose</code></pre>
  </div>
  <p>
    Alternatively, you can download the
    <a href="https://github.com/kubernetes/kompose/releases">
      tarball
    </a>
    .
  </p>
</div>
<div id="install-ways-1">
  <p>
    Installing using
    <code>
      go get
    </code>
    pulls from the master branch with the latest development changes.
  </p>
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">go get -u github.com/kubernetes/kompose</code></pre>
  </div>
  <p>
</div>
<div id="install-ways-2">
  <p>
    Kompose is in
    <a href="https://fedoraproject.org/wiki/EPEL">
      EPEL
    </a>
    CentOS repository.
    If you don&rsquo;t have
    <a href="https://fedoraproject.org/wiki/EPEL">
      EPEL
    </a>
    repository already installed and enabled you can do it by running
    <code>
      sudo yum install epel-release
    </code>
  </p>
  <p>
    If you have
    <a href="https://fedoraproject.org/wiki/EPEL">
      EPEL
    </a>
    enabled in your system, you can install Kompose like any other package.
  </p>
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo yum -y install kompose</code></pre>
  </div>
  <p>
</div>
<div id="install-ways-3">
  <p>
    Kompose is in Fedora 24, 25 and 26 repositories. You can install it just like any other package.
  </p>
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo dnf -y install kompose</code></pre>
  </div>
  <p>
</div>
<div id="install-ways-4">
  <p>
    On macOS you can install latest release via
    <a href="https://brew.sh">
      Homebrew
    </a>
    :
  </p>
  <div class="highlight">
    <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">brew install kompose</code></pre>
  </div>
  <p>
</div>
<p>
<script>
  $(function(){$("#install-ways").tabs();});
</script>
<h2 id="use-kompose">
  Use Kompose
</h2>
<p>
  In just a few steps, we&rsquo;ll take you from Docker Compose to Kubernetes. All
  you need is an existing
  <code>
    docker-compose.yml
  </code>
  file.
</p>
<ol>
  <li>
    <p>
      Go to the directory containing your
      <code>
        docker-compose.yml
      </code>
      file. If you don&rsquo;t
      have one, test using this one.
    </p>
    <div class="highlight">
      <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;2&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">services</span>:<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">redis-master</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>k8s.gcr.io/redis:e2e<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">ports</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>- <span style="color:#b44">&#34;6379&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">redis-slave</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>gcr.io/google_samples/gb-redisslave:v3<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">ports</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>- <span style="color:#b44">&#34;6379&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">environment</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>- GET_HOSTS_FROM=dns<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">frontend</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>gcr.io/google-samples/gb-frontend:v4<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">ports</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>- <span style="color:#b44">&#34;80:80&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">environment</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>- GET_HOSTS_FROM=dns<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">labels</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">kompose.service.type</span>:<span style="color:#bbb"> </span>LoadBalancer</code></pre>
    </div>
  </li>
  <li>
    <p>
      Run the
      <code>
        kompose up
      </code>
      command to deploy to Kubernetes directly, or skip to
      the next step instead to generate a file to use with
      <code>
        kubectl
      </code>
      .
    </p>
    <div class="highlight">
      <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  $ kompose up
  We are going to create Kubernetes Deployments, Services and PersistentVolumeClaims <span style="color:#a2f;font-weight:bold">for</span> your Dockerized application.
  If you need different kind of resources, use the <span style="color:#b44">&#39;kompose convert&#39;</span> and <span style="color:#b44">&#39;kubectl apply -f&#39;</span> commands instead.

  INFO Successfully created Service: redis          
  INFO Successfully created Service: web            
  INFO Successfully created Deployment: redis       
  INFO Successfully created Deployment: web         

  Your application has been deployed to Kubernetes. You can run <span style="color:#b44">&#39;kubectl get deployment,svc,pods,pvc&#39;</span> <span style="color:#a2f;font-weight:bold">for</span> details.</code></pre>
    </div>
  </li>
  <li>
    <p>
      To convert the
      <code>
        docker-compose.yml
      </code>
      file to files that you can use with
      <code>
        kubectl
      </code>
      , run
      <code>
        kompose convert
      </code>
      and then
      <code>
        kubectl apply -f &lt;output file&gt;
      </code>
      .
    </p>
    <div class="highlight">
      <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  $ kompose convert                           
  INFO Kubernetes file <span style="color:#b44">&#34;frontend-service.yaml&#34;</span> created         
  INFO Kubernetes file <span style="color:#b44">&#34;redis-master-service.yaml&#34;</span> created     
  INFO Kubernetes file <span style="color:#b44">&#34;redis-slave-service.yaml&#34;</span> created      
  INFO Kubernetes file <span style="color:#b44">&#34;frontend-deployment.yaml&#34;</span> created      
  INFO Kubernetes file <span style="color:#b44">&#34;redis-master-deployment.yaml&#34;</span> created  
  INFO Kubernetes file <span style="color:#b44">&#34;redis-slave-deployment.yaml&#34;</span> created   </code></pre>
    </div>
    <div class="highlight">
      <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  $ kubectl apply -f frontend-service.yaml,redis-master-service.yaml,redis-slave-service.yaml,frontend-deployment.yaml,redis-master-deployment.yaml,redis-slave-deployment.yaml
  service/frontend created
  service/redis-master created
  service/redis-slave created
  deployment.apps/frontend created
  deployment.apps/redis-master created
  deployment.apps/redis-slave created</code></pre>
    </div>
    <p>
      Your deployments are running in Kubernetes.
    </p>
  </li>
  <li>
    <p>
      Access your application.
    </p>
    <p>
      If you&rsquo;re already using
      <code>
        minikube
      </code>
      for your development process:
    </p>
    <div class="highlight">
      <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  $ minikube service frontend</code></pre>
    </div>
    <p>
      Otherwise, let&rsquo;s look up what IP your service is using!
    </p>
    <div class="highlight">
      <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">  $ kubectl describe svc frontend
  Name:                   frontend
  Namespace:              default
  Labels:                 <span style="color:#b8860b">service</span><span style="color:#666">=</span>frontend
  Selector:               <span style="color:#b8860b">service</span><span style="color:#666">=</span>frontend
  Type:                   LoadBalancer
  IP:                     10.0.0.183
  LoadBalancer Ingress:   192.0.2.89
  Port:                   <span style="color:#666">80</span>      80/TCP
  NodePort:               <span style="color:#666">80</span>      31144/TCP
  Endpoints:              172.17.0.4:80
  Session Affinity:       None
  No events.</code></pre>
    </div>
    <p>
      If you&rsquo;re using a cloud provider, your IP will be listed next to
      <code>
        LoadBalancer Ingress
      </code>
      .
    </p>
    <div class="highlight">
      <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">  $ curl http://192.0.2.89</code></pre>
    </div>
  </li>
</ol>
<h2 id="user-guide">
  User Guide
</h2>
<ul>
  <li>
    CLI
    <ul>
      <li>
        <a href="#kompose-convert">
          <code>
            kompose convert
          </code>
        </a>
      </li>
      <li>
        <a href="#kompose-up">
          <code>
            kompose up
          </code>
        </a>
      </li>
      <li>
        <a href="#kompose-down">
          <code>
            kompose down
          </code>
        </a>
      </li>
    </ul>
  </li>
  <li>
    Documentation
    <ul>
      <li>
        <a href="#build-and-push-docker-images">
          Build and Push Docker Images
        </a>
      </li>
      <li>
        <a href="#alternative-conversions">
          Alternative Conversions
        </a>
      </li>
      <li>
        <a href="#labels">
          Labels
        </a>
      </li>
      <li>
        <a href="#restart">
          Restart
        </a>
      </li>
      <li>
        <a href="#docker-compose-versions">
          Docker Compose Versions
        </a>
      </li>
    </ul>
  </li>
</ul>
<p>
  Kompose has support for two providers: OpenShift and Kubernetes.
  You can choose a targeted provider using global option
  <code>
    --provider
  </code>
  . If no provider is specified, Kubernetes is set by default.
</p>
<h2 id="kompose-convert">
  <code>
    kompose convert
  </code>
</h2>
<p>
  Kompose supports conversion of V1, V2, and V3 Docker Compose files into Kubernetes and OpenShift objects.
</p>
<h3 id="kubernetes">
  Kubernetes
</h3>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ kompose --file docker-voting.yml convert
WARN Unsupported key networks - ignoring
WARN Unsupported key build - ignoring
INFO Kubernetes file <span style="color:#b44">&#34;worker-svc.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;db-svc.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;redis-svc.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;result-svc.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;vote-svc.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;redis-deployment.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;result-deployment.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;vote-deployment.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;worker-deployment.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;db-deployment.yaml&#34;</span> created

$ ls
db-deployment.yaml  docker-compose.yml         docker-gitlab.yml  redis-deployment.yaml  result-deployment.yaml  vote-deployment.yaml  worker-deployment.yaml
db-svc.yaml         docker-voting.yml          redis-svc.yaml     result-svc.yaml        vote-svc.yaml           worker-svc.yaml</code></pre>
</div>
<p>
  You can also provide multiple docker-compose files at the same time:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ kompose -f docker-compose.yml -f docker-guestbook.yml convert
INFO Kubernetes file <span style="color:#b44">&#34;frontend-service.yaml&#34;</span> created         
INFO Kubernetes file <span style="color:#b44">&#34;mlbparks-service.yaml&#34;</span> created         
INFO Kubernetes file <span style="color:#b44">&#34;mongodb-service.yaml&#34;</span> created          
INFO Kubernetes file <span style="color:#b44">&#34;redis-master-service.yaml&#34;</span> created     
INFO Kubernetes file <span style="color:#b44">&#34;redis-slave-service.yaml&#34;</span> created      
INFO Kubernetes file <span style="color:#b44">&#34;frontend-deployment.yaml&#34;</span> created      
INFO Kubernetes file <span style="color:#b44">&#34;mlbparks-deployment.yaml&#34;</span> created      
INFO Kubernetes file <span style="color:#b44">&#34;mongodb-deployment.yaml&#34;</span> created       
INFO Kubernetes file <span style="color:#b44">&#34;mongodb-claim0-persistentvolumeclaim.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;redis-master-deployment.yaml&#34;</span> created  
INFO Kubernetes file <span style="color:#b44">&#34;redis-slave-deployment.yaml&#34;</span> created   

$ ls
mlbparks-deployment.yaml  mongodb-service.yaml                       redis-slave-service.jsonmlbparks-service.yaml  
frontend-deployment.yaml  mongodb-claim0-persistentvolumeclaim.yaml  redis-master-service.yaml
frontend-service.yaml     mongodb-deployment.yaml                    redis-slave-deployment.yaml
redis-master-deployment.yaml</code></pre>
</div>
<p>
  When multiple docker-compose files are provided the configuration is merged. Any configuration that is common will be over ridden by subsequent file.
</p>
<h3 id="openshift">
  OpenShift
</h3>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ kompose --provider openshift --file docker-voting.yml convert
WARN <span style="color:#666">[</span>worker<span style="color:#666">]</span> Service cannot be created because of missing port.
INFO OpenShift file <span style="color:#b44">&#34;vote-service.yaml&#34;</span> created             
INFO OpenShift file <span style="color:#b44">&#34;db-service.yaml&#34;</span> created               
INFO OpenShift file <span style="color:#b44">&#34;redis-service.yaml&#34;</span> created            
INFO OpenShift file <span style="color:#b44">&#34;result-service.yaml&#34;</span> created           
INFO OpenShift file <span style="color:#b44">&#34;vote-deploymentconfig.yaml&#34;</span> created    
INFO OpenShift file <span style="color:#b44">&#34;vote-imagestream.yaml&#34;</span> created         
INFO OpenShift file <span style="color:#b44">&#34;worker-deploymentconfig.yaml&#34;</span> created  
INFO OpenShift file <span style="color:#b44">&#34;worker-imagestream.yaml&#34;</span> created       
INFO OpenShift file <span style="color:#b44">&#34;db-deploymentconfig.yaml&#34;</span> created      
INFO OpenShift file <span style="color:#b44">&#34;db-imagestream.yaml&#34;</span> created           
INFO OpenShift file <span style="color:#b44">&#34;redis-deploymentconfig.yaml&#34;</span> created   
INFO OpenShift file <span style="color:#b44">&#34;redis-imagestream.yaml&#34;</span> created        
INFO OpenShift file <span style="color:#b44">&#34;result-deploymentconfig.yaml&#34;</span> created  
INFO OpenShift file <span style="color:#b44">&#34;result-imagestream.yaml&#34;</span> created  </code></pre>
</div>
<p>
  It also supports creating buildconfig for build directive in a service. By default, it uses the remote repo for the current git branch as the source repo, and the current branch as the source branch for the build. You can specify a different source repo and branch using
  <code>
    --build-repo
  </code>
  and
  <code>
    --build-branch
  </code>
  options respectively.
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ kompose --provider openshift --file buildconfig/docker-compose.yml convert
WARN <span style="color:#666">[</span>foo<span style="color:#666">]</span> Service cannot be created because of missing port.
INFO OpenShift Buildconfig using git@github.com:rtnpro/kompose.git::master as source.
INFO OpenShift file <span style="color:#b44">&#34;foo-deploymentconfig.yaml&#34;</span> created     
INFO OpenShift file <span style="color:#b44">&#34;foo-imagestream.yaml&#34;</span> created          
INFO OpenShift file <span style="color:#b44">&#34;foo-buildconfig.yaml&#34;</span> created</code></pre>
</div>
<blockquote class="note">
  <div>
    <strong>
      Note:
    </strong>
    If you are manually pushing the OpenShift artifacts using
    <code>
      oc create -f
    </code>
    , you need to ensure that you push the imagestream artifact before the buildconfig artifact, to workaround this OpenShift issue:
    <a href="https://github.com/openshift/origin/issues/4518">
      https://github.com/openshift/origin/issues/4518
    </a>
    .
  </div>
</blockquote>
<h2 id="kompose-up">
  <code>
    kompose up
  </code>
</h2>
<p>
  Kompose supports a straightforward way to deploy your &ldquo;composed&rdquo; application to Kubernetes or OpenShift via
  <code>
    kompose up
  </code>
  .
</p>
<h3 id="kubernetes-1">
  Kubernetes
</h3>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ kompose --file ./examples/docker-guestbook.yml up
We are going to create Kubernetes deployments and services <span style="color:#a2f;font-weight:bold">for</span> your Dockerized application.
If you need different kind of resources, use the <span style="color:#b44">&#39;kompose convert&#39;</span> and <span style="color:#b44">&#39;kubectl apply -f&#39;</span> commands instead.

INFO Successfully created service: redis-master   
INFO Successfully created service: redis-slave    
INFO Successfully created service: frontend       
INFO Successfully created deployment: redis-master
INFO Successfully created deployment: redis-slave
INFO Successfully created deployment: frontend    

Your application has been deployed to Kubernetes. You can run <span style="color:#b44">&#39;kubectl get deployment,svc,pods&#39;</span> <span style="color:#a2f;font-weight:bold">for</span> details.

$ kubectl get deployment,svc,pods
NAME                                              DESIRED       CURRENT       UP-TO-DATE   AVAILABLE   AGE
deployment.extensions/frontend                    <span style="color:#666">1</span>             <span style="color:#666">1</span>             <span style="color:#666">1</span>            <span style="color:#666">1</span>           4m
deployment.extensions/redis-master                <span style="color:#666">1</span>             <span style="color:#666">1</span>             <span style="color:#666">1</span>            <span style="color:#666">1</span>           4m
deployment.extensions/redis-slave                 <span style="color:#666">1</span>             <span style="color:#666">1</span>             <span style="color:#666">1</span>            <span style="color:#666">1</span>           4m

NAME                         TYPE               CLUSTER-IP    EXTERNAL-IP   PORT<span style="color:#666">(</span>S<span style="color:#666">)</span>      AGE
service/frontend             ClusterIP          10.0.174.12   &lt;none&gt;        80/TCP       4m
service/kubernetes           ClusterIP          10.0.0.1      &lt;none&gt;        443/TCP      13d
service/redis-master         ClusterIP          10.0.202.43   &lt;none&gt;        6379/TCP     4m
service/redis-slave          ClusterIP          10.0.1.85     &lt;none&gt;        6379/TCP     4m

NAME                                READY         STATUS        RESTARTS     AGE
pod/frontend-2768218532-cs5t5       1/1           Running       <span style="color:#666">0</span>            4m
pod/redis-master-1432129712-63jn8   1/1           Running       <span style="color:#666">0</span>            4m
pod/redis-slave-2504961300-nve7b    1/1           Running       <span style="color:#666">0</span>            4m</code></pre>
</div>
<p>
  <strong>
    Note
  </strong>
  :
</p>
<ul>
  <li>
    You must have a running Kubernetes cluster with a pre-configured kubectl context.
  </li>
  <li>
    Only deployments and services are generated and deployed to Kubernetes. If you need different kind of resources, use the
    <code>
      kompose convert
    </code>
    and
    <code>
      kubectl apply -f
    </code>
    commands instead.
  </li>
</ul>
<h3 id="openshift-1">
  OpenShift
</h3>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ kompose --file ./examples/docker-guestbook.yml --provider openshift up
We are going to create OpenShift DeploymentConfigs and Services <span style="color:#a2f;font-weight:bold">for</span> your Dockerized application.
If you need different kind of resources, use the <span style="color:#b44">&#39;kompose convert&#39;</span> and <span style="color:#b44">&#39;oc create -f&#39;</span> commands instead.

INFO Successfully created service: redis-slave    
INFO Successfully created service: frontend       
INFO Successfully created service: redis-master   
INFO Successfully created deployment: redis-slave
INFO Successfully created ImageStream: redis-slave
INFO Successfully created deployment: frontend    
INFO Successfully created ImageStream: frontend   
INFO Successfully created deployment: redis-master
INFO Successfully created ImageStream: redis-master

Your application has been deployed to OpenShift. You can run <span style="color:#b44">&#39;oc get dc,svc,is&#39;</span> <span style="color:#a2f;font-weight:bold">for</span> details.

$ oc get dc,svc,is
NAME               REVISION                              DESIRED       CURRENT    TRIGGERED BY
dc/frontend        <span style="color:#666">0</span>                                     <span style="color:#666">1</span>             <span style="color:#666">0</span>          config,image<span style="color:#666">(</span>frontend:v4<span style="color:#666">)</span>
dc/redis-master    <span style="color:#666">0</span>                                     <span style="color:#666">1</span>             <span style="color:#666">0</span>          config,image<span style="color:#666">(</span>redis-master:e2e<span style="color:#666">)</span>
dc/redis-slave     <span style="color:#666">0</span>                                     <span style="color:#666">1</span>             <span style="color:#666">0</span>          config,image<span style="color:#666">(</span>redis-slave:v1<span style="color:#666">)</span>
NAME               CLUSTER-IP                            EXTERNAL-IP   PORT<span style="color:#666">(</span>S<span style="color:#666">)</span>    AGE
svc/frontend       172.30.46.64                          &lt;none&gt;        80/TCP     8s
svc/redis-master   172.30.144.56                         &lt;none&gt;        6379/TCP   8s
svc/redis-slave    172.30.75.245                         &lt;none&gt;        6379/TCP   8s
NAME               DOCKER REPO                           TAGS          UPDATED
is/frontend        172.30.12.200:5000/fff/frontend                     
is/redis-master    172.30.12.200:5000/fff/redis-master                 
is/redis-slave     172.30.12.200:5000/fff/redis-slave    v1  </code></pre>
</div>
<p>
  <strong>
    Note
  </strong>
  :
</p>
<ul>
  <li>
    You must have a running OpenShift cluster with a pre-configured
    <code>
      oc
    </code>
    context (
    <code>
      oc login
    </code>
    )
  </li>
</ul>
<h2 id="kompose-down">
  <code>
    kompose down
  </code>
</h2>
<p>
  Once you have deployed &ldquo;composed&rdquo; application to Kubernetes,
  <code>
    $ kompose down
  </code>
  will help you to take the application out by deleting its deployments and services. If you need to remove other resources, use the &lsquo;kubectl&rsquo; command.
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ kompose --file docker-guestbook.yml down
INFO Successfully deleted service: redis-master   
INFO Successfully deleted deployment: redis-master
INFO Successfully deleted service: redis-slave    
INFO Successfully deleted deployment: redis-slave
INFO Successfully deleted service: frontend       
INFO Successfully deleted deployment: frontend</code></pre>
</div>
<p>
  <strong>
    Note
  </strong>
  :
</p>
<ul>
  <li>
    You must have a running Kubernetes cluster with a pre-configured kubectl context.
  </li>
</ul>
<h2 id="build-and-push-docker-images">
  Build and Push Docker Images
</h2>
<p>
  Kompose supports both building and pushing Docker images. When using the
  <code>
    build
  </code>
  key within your Docker Compose file, your image will:
</p>
<ul>
  <li>
    Automatically be built with Docker using the
    <code>
      image
    </code>
    key specified within your file
  </li>
  <li>
    Be pushed to the correct Docker repository using local credentials (located at
    <code>
      .docker/config
    </code>
    )
  </li>
</ul>
<p>
  Using an
  <a href="https://raw.githubusercontent.com/kubernetes/kompose/master/examples/buildconfig/docker-compose.yml">
    example Docker Compose file
  </a>
  :
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;2&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">services</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">foo</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">build</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;./build&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>docker.io/foo/bar</code></pre>
</div>
<p>
  Using
  <code>
    kompose up
  </code>
  with a
  <code>
    build
  </code>
  key:
</p><pre><code class="language-none" data-lang="none">$ kompose up
INFO Build key detected. Attempting to build and push image &#39;docker.io/foo/bar&#39;
INFO Building image &#39;docker.io/foo/bar&#39; from directory &#39;build&#39;
INFO Image &#39;docker.io/foo/bar&#39; from directory &#39;build&#39; built successfully
INFO Pushing image &#39;foo/bar:latest&#39; to registry &#39;docker.io&#39;
INFO Attempting authentication credentials &#39;https://index.docker.io/v1/
INFO Successfully pushed image &#39;foo/bar:latest&#39; to registry &#39;docker.io&#39;
INFO We are going to create Kubernetes Deployments, Services and PersistentVolumeClaims for your Dockerized application. If you need different kind of resources, use the &#39;kompose convert&#39; and &#39;kubectl apply -f&#39; commands instead.

INFO Deploying application in &#34;default&#34; namespace
INFO Successfully created Service: foo            
INFO Successfully created Deployment: foo         

Your application has been deployed to Kubernetes. You can run &#39;kubectl get deployment,svc,pods,pvc&#39; for details.</code></pre>
<p>
  In order to disable the functionality, or choose to use BuildConfig generation (with OpenShift)
  <code>
    --build (local|build-config|none)
  </code>
  can be passed.
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#080;font-style:italic"># Disable building/pushing Docker images</span>
$ kompose up --build none

<span style="color:#080;font-style:italic"># Generate Build Config artifacts for OpenShift</span>
$ kompose up --provider openshift --build build-config</code></pre>
</div>
<h2 id="alternative-conversions">
  Alternative Conversions
</h2>
<p>
  The default
  <code>
    kompose
  </code>
  transformation will generate Kubernetes
  <a href="/docs/concepts/workloads/controllers/deployment/">
    Deployments
  </a>
  and
  <a href="/docs/concepts/services-networking/service/">
    Services
  </a>
  , in yaml format. You have alternative option to generate json with
  <code>
    -j
  </code>
  . Also, you can alternatively generate
  <a href="/docs/concepts/workloads/controllers/replicationcontroller/">
    Replication Controllers
  </a>
  objects,
  <a href="/docs/concepts/workloads/controllers/daemonset/">
    Daemon Sets
  </a>
  , or
  <a href="https://github.com/helm/helm">
    Helm
  </a>
  charts.
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ kompose convert -j
INFO Kubernetes file <span style="color:#b44">&#34;redis-svc.json&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;web-svc.json&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;redis-deployment.json&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;web-deployment.json&#34;</span> created</code></pre>
</div>
<p>
  The
  <code>
    *-deployment.json
  </code>
  files contain the Deployment objects.
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ kompose convert --replication-controller
INFO Kubernetes file <span style="color:#b44">&#34;redis-svc.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;web-svc.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;redis-replicationcontroller.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;web-replicationcontroller.yaml&#34;</span> created</code></pre>
</div>
<p>
  The
  <code>
    *-replicationcontroller.yaml
  </code>
  files contain the Replication Controller objects. If you want to specify replicas (default is 1), use
  <code>
    --replicas
  </code>
  flag:
  <code>
    $ kompose convert --replication-controller --replicas 3
  </code>
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ kompose convert --daemon-set
INFO Kubernetes file <span style="color:#b44">&#34;redis-svc.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;web-svc.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;redis-daemonset.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;web-daemonset.yaml&#34;</span> created</code></pre>
</div>
<p>
  The
  <code>
    *-daemonset.yaml
  </code>
  files contain the Daemon Set objects
</p>
<p>
  If you want to generate a Chart to be used with
  <a href="https://github.com/kubernetes/helm">
    Helm
  </a>
  simply do:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ kompose convert -c
INFO Kubernetes file <span style="color:#b44">&#34;web-svc.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;redis-svc.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;web-deployment.yaml&#34;</span> created
INFO Kubernetes file <span style="color:#b44">&#34;redis-deployment.yaml&#34;</span> created
chart created in <span style="color:#b44">&#34;./docker-compose/&#34;</span>

$ tree docker-compose/
docker-compose
├── Chart.yaml
├── README.md
└── templates
    ├── redis-deployment.yaml
    ├── redis-svc.yaml
    ├── web-deployment.yaml
    └── web-svc.yaml</code></pre>
</div>
<p>
  The chart structure is aimed at providing a skeleton for building your Helm charts.
</p>
<h2 id="labels">
  Labels
</h2>
<p>
  <code>
    kompose
  </code>
  supports Kompose-specific labels within the
  <code>
    docker-compose.yml
  </code>
  file in order to explicitly define a service&rsquo;s behavior upon conversion.
</p>
<ul>
  <li>
    <code>
      kompose.service.type
    </code>
    defines the type of service to be created.
  </li>
</ul>
<p>
  For example:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;2&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">services</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">nginx</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>nginx<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">dockerfile</span>:<span style="color:#bbb"> </span>foobar<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">build</span>:<span style="color:#bbb"> </span>./foobar<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">cap_add</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- ALL<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">container_name</span>:<span style="color:#bbb"> </span>foobar<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">labels</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">kompose.service.type</span>:<span style="color:#bbb"> </span>nodeport</code></pre>
</div>
<ul>
  <li>
    <code>
      kompose.service.expose
    </code>
    defines if the service needs to be made accessible from outside the cluster or not. If the value is set to &ldquo;true&rdquo;, the provider sets the endpoint automatically, and for any other value, the value is set as the hostname. If multiple ports are defined in a service, the first one is chosen to be the exposed.
    <ul>
      <li>
        For the Kubernetes provider, an ingress resource is created and it is assumed that an ingress controller has already been configured.
      </li>
      <li>
        For the OpenShift provider, a route is created.
      </li>
    </ul>
  </li>
</ul>
<p>
  For example:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;2&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">services</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">web</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>tuna/docker-counter23<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">ports</span>:<span style="color:#bbb">
</span><span style="color:#bbb">     </span>- <span style="color:#b44">&#34;5000:5000&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">links</span>:<span style="color:#bbb">
</span><span style="color:#bbb">     </span>- redis<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">labels</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#a2f;font-weight:bold">kompose.service.expose</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;counter.example.com&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">redis</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>redis:<span style="color:#666">3.0</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">ports</span>:<span style="color:#bbb">
</span><span style="color:#bbb">     </span>- <span style="color:#b44">&#34;6379&#34;</span></code></pre>
</div>
<p>
  The currently supported options are:
</p>
<table>
  <thead>
    <tr>
      <th>
        Key
      </th>
      <th>
        Value
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        kompose.service.type
      </td>
      <td>
        nodeport / clusterip / loadbalancer
      </td>
    </tr>
    <tr>
      <td>
        kompose.service.expose
      </td>
      <td>
        true / hostname
      </td>
    </tr>
  </tbody>
</table>
<blockquote class="note">
  <div>
    <strong>
      Note:
    </strong>
    The
    <code>
      kompose.service.type
    </code>
    label should be defined with
    <code>
      ports
    </code>
    only, otherwise
    <code>
      kompose
    </code>
    will fail.
  </div>
</blockquote>
<h2 id="restart">
  Restart
</h2>
<p>
  If you want to create normal pods without controllers you can use
  <code>
    restart
  </code>
  construct of docker-compose to define that. Follow table below to see what happens on the
  <code>
    restart
  </code>
  value.
</p>
<table>
  <thead>
    <tr>
      <th>
        <code>
          docker-compose
        </code>
        <code>
          restart
        </code>
      </th>
      <th>
        object created
      </th>
      <th>
        Pod
        <code>
          restartPolicy
        </code>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <code>
          &quot;&quot;
        </code>
      </td>
      <td>
        controller object
      </td>
      <td>
        <code>
          Always
        </code>
      </td>
    </tr>
    <tr>
      <td>
        <code>
          always
        </code>
      </td>
      <td>
        controller object
      </td>
      <td>
        <code>
          Always
        </code>
      </td>
    </tr>
    <tr>
      <td>
        <code>
          on-failure
        </code>
      </td>
      <td>
        Pod
      </td>
      <td>
        <code>
          OnFailure
        </code>
      </td>
    </tr>
    <tr>
      <td>
        <code>
          no
        </code>
      </td>
      <td>
        Pod
      </td>
      <td>
        <code>
          Never
        </code>
      </td>
    </tr>
  </tbody>
</table>
<blockquote class="note">
  <div>
    <strong>
      Note:
    </strong>
    The controller object could be
    <code>
      deployment
    </code>
    or
    <code>
      replicationcontroller
    </code>
    , etc.
  </div>
</blockquote>
<p>
  For example, the
  <code>
    pival
  </code>
  service will become pod down here. This container calculated value of
  <code>
    pi
  </code>
  .
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#a2f;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#39;2&#39;</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">services</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#a2f;font-weight:bold">pival</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">image</span>:<span style="color:#bbb"> </span>perl<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">command</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">&#34;perl&#34;</span>,<span style="color:#bbb">  </span><span style="color:#b44">&#34;-Mbignum=bpi&#34;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;-wle&#34;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;print bpi(2000)&#34;</span>]<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">restart</span>:<span style="color:#bbb"> </span><span style="color:#b44">&#34;on-failure&#34;</span></code></pre>
</div>
<h3 id="warning-about-deployment-config-s">
  Warning about Deployment Config&rsquo;s
</h3>
<p>
  If the Docker Compose file has a volume specified for a service, the Deployment (Kubernetes) or DeploymentConfig (OpenShift) strategy is changed to &ldquo;Recreate&rdquo; instead of &ldquo;RollingUpdate&rdquo; (default). This is done to avoid multiple instances of a service from accessing a volume at the same time.
</p>
<p>
  If the Docker Compose file has service name with
  <code>
    _
  </code>
  in it (eg.
  <code>
    web_service
  </code>
  ), then it will be replaced by
  <code>
    -
  </code>
  and the service name will be renamed accordingly (eg.
  <code>
    web-service
  </code>
  ). Kompose does this because &ldquo;Kubernetes&rdquo; doesn&rsquo;t allow
  <code>
    _
  </code>
  in object name.
</p>
<p>
  Please note that changing service name might break some
  <code>
    docker-compose
  </code>
  files.
</p>
<h2 id="docker-compose-versions">
  Docker Compose Versions
</h2>
<p>
  Kompose supports Docker Compose versions: 1, 2 and 3. We have limited support on versions 2.1 and 3.2 due to their experimental nature.
</p>
<p>
  A full list on compatibility between all three versions is listed in our
  <a href="https://github.com/kubernetes/kompose/blob/master/docs/conversion.md">
    conversion document
  </a>
  including a list of all incompatible Docker Compose keys.
</p>
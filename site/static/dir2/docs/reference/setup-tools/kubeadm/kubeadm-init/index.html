<html>
<body>
<h1>
  kubeadm init
</h1>
<p>
  <a href="https://github.com/kubernetes/website/edit/master/content/en/docs/reference/setup-tools/kubeadm/kubeadm-init.md" id="editPageButton" target="_blank">
    Edit This Page
  </a>
</p>
<h1>
  kubeadm init
</h1>
<p>
  This command initializes a Kubernetes control-plane node.
</p>
<ul id="markdown-toc">
  <li>
    <a href="#what-s-next">
      What's next
    </a>
  </li>
</ul>
<pre><code>&lt;h3 id=&quot;synopsis&quot;&gt;Synopsis&lt;/h3&gt;</code></pre>
<p>
  Run this command in order to set up the Kubernetes control plane
</p>
<p>
  The &ldquo;init&rdquo; command executes the following phases:
</p>
<pre><code>preflight                    Run pre-flight checks
kubelet-start                Write kubelet settings and (re)start the kubelet
certs                        Certificate generation
  /ca                          Generate the self-signed Kubernetes CA to provision identities for other Kubernetes components
  /apiserver                   Generate the certificate for serving the Kubernetes API
  /apiserver-kubelet-client    Generate the certificate for the API server to connect to kubelet
  /front-proxy-ca              Generate the self-signed CA to provision identities for front proxy
  /front-proxy-client          Generate the certificate for the front proxy client
  /etcd-ca                     Generate the self-signed CA to provision identities for etcd
  /etcd-server                 Generate the certificate for serving etcd
  /etcd-peer                   Generate the certificate for etcd nodes to communicate with each other
  /etcd-healthcheck-client     Generate the certificate for liveness probes to healthcheck etcd
  /apiserver-etcd-client       Generate the certificate the apiserver uses to access etcd
  /sa                          Generate a private key for signing service account tokens along with its public key
kubeconfig                   Generate all kubeconfig files necessary to establish the control plane and the admin kubeconfig file
  /admin                       Generate a kubeconfig file for the admin to use and for kubeadm itself
  /kubelet                     Generate a kubeconfig file for the kubelet to use *only* for cluster bootstrapping purposes
  /controller-manager          Generate a kubeconfig file for the controller manager to use
  /scheduler                   Generate a kubeconfig file for the scheduler to use
control-plane                Generate all static Pod manifest files necessary to establish the control plane
  /apiserver                   Generates the kube-apiserver static Pod manifest
  /controller-manager          Generates the kube-controller-manager static Pod manifest
  /scheduler                   Generates the kube-scheduler static Pod manifest
etcd                         Generate static Pod manifest file for local etcd
  /local                       Generate the static Pod manifest file for a local, single-node local etcd instance
upload-config                Upload the kubeadm and kubelet configuration to a ConfigMap
  /kubeadm                     Upload the kubeadm ClusterConfiguration to a ConfigMap
  /kubelet                     Upload the kubelet component config to a ConfigMap
upload-certs                 Upload certificates to kubeadm-certs
mark-control-plane           Mark a node as a control-plane
bootstrap-token              Generates bootstrap tokens used to join a node to a cluster
kubelet-finalize             Updates settings relevant to the kubelet after TLS bootstrap
  /experimental-cert-rotation  Enable kubelet client certificate rotation
addon                        Install required addons for passing Conformance tests
  /coredns                     Install the CoreDNS addon to a Kubernetes cluster
  /kube-proxy                  Install the kube-proxy addon to a Kubernetes cluster</code></pre>
<pre><code>kubeadm init [flags]</code></pre>
<h3 id="options">
  Options
</h3>
<table style="width: 100%; table-layout: fixed;">
  <colgroup>
    <col span="1" style="width: 10px;" />
    <col span="1" />
  </colgroup>
  <tbody>
    <tr>
      <td colspan="2">
        --apiserver-advertise-address string
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        The IP address the API Server will advertise it's listening on. If not set the default network interface will be used.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --apiserver-bind-port int32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default: 6443
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Port for the API Server to bind to.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --apiserver-cert-extra-sans stringSlice
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Optional extra Subject Alternative Names (SANs) to use for the API Server serving certificate. Can be both IP addresses and DNS names.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --cert-dir string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default: "/etc/kubernetes/pki"
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        The path where to save and store the certificates.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --certificate-key string
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Key used to encrypt the control-plane certificates in the kubeadm-certs Secret.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --config string
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Path to a kubeadm configuration file.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --control-plane-endpoint string
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Specify a stable IP address or DNS name for the control plane.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --cri-socket string
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Path to the CRI socket to connect. If empty kubeadm will try to auto-detect this value; use this option only if you have more than one CRI installed or if you have non-standard CRI socket.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --dry-run
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Don't apply any changes; just output what would be done.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        -k, --experimental-kustomize string
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        The path where kustomize patches for static pod manifests are stored.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --feature-gates string
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        A set of key=value pairs that describe feature gates for various features. Options are:
        <br/>
        IPv6DualStack=true|false (ALPHA - default=false)
        <br/>
        PublicKeysECDSA=true|false (ALPHA - default=false)
      </td>
    </tr>
    <tr>
      <td colspan="2">
        -h, --help
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        help for init
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --ignore-preflight-errors stringSlice
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        A list of checks whose errors will be shown as warnings. Example: 'IsPrivilegedUser,Swap'. Value 'all' ignores errors from all checks.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --image-repository string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default: "k8s.gcr.io"
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Choose a container registry to pull control plane images from
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --kubernetes-version string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default: "stable-1"
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Choose a specific Kubernetes version for the control plane.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --node-name string
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Specify the node name.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --pod-network-cidr string
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Specify range of IP addresses for the pod network. If set, the control plane will automatically allocate CIDRs for every node.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --service-cidr string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default: "10.96.0.0/12"
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Use alternative range of IP address for service VIPs.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --service-dns-domain string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default: "cluster.local"
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Use alternative domain for services, e.g. "myorg.internal".
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --skip-certificate-key-print
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Don't print the key used to encrypt the control-plane certificates.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --skip-phases stringSlice
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        List of phases to be skipped
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --skip-token-print
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Skip printing of the default bootstrap token generated by 'kubeadm init'.
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --token string
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        The token to use for establishing bidirectional trust between nodes and control-plane nodes. The format is [a-z0-9]{6}\.[a-z0-9]{16} - e.g. abcdef.0123456789abcdef
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --token-ttl duration&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default: 24h0m0s
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        The duration before the token is automatically deleted (e.g. 1s, 2m, 3h). If set to '0', the token will never expire
      </td>
    </tr>
    <tr>
      <td colspan="2">
        --upload-certs
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        Upload control-plane certificates to the kubeadm-certs Secret.
      </td>
    </tr>
  </tbody>
</table>
<h3 id="options-inherited-from-parent-commands">
  Options inherited from parent commands
</h3>
<table style="width: 100%; table-layout: fixed;">
  <colgroup>
    <col span="1" style="width: 10px;" />
    <col span="1" />
  </colgroup>
  <tbody>
    <tr>
      <td colspan="2">
        --rootfs string
      </td>
    </tr>
    <tr>
      <td></td>
      <td style="line-height: 130%; word-wrap: break-word;">
        [EXPERIMENTAL] The path to the 'real' host root filesystem.
      </td>
    </tr>
  </tbody>
</table>
<h3 id="init-workflow">
  Init workflow
</h3>
<p>
  <code>
    kubeadm init
  </code>
  bootstraps a Kubernetes control-plane node by executing the
  following steps:
</p>
<ol>
  <li>
    <p>
      Runs a series of pre-flight checks to validate the system state
      before making changes. Some checks only trigger warnings, others are
      considered errors and will exit kubeadm until the problem is corrected or the
      user specifies
      <code>
        --ignore-preflight-errors=&lt;list-of-errors&gt;
      </code>
      .
    </p>
  </li>
  <li>
    <p>
      Generates a self-signed CA (or using an existing one if provided) to set up
      identities for each component in the cluster. If the user has provided their
      own CA cert and/or key by dropping it in the cert directory configured via
      <code>
        --cert-dir
      </code>
      (
      <code>
        /etc/kubernetes/pki
      </code>
      by default).
      The APIServer certs will have additional SAN entries for any
      <code>
        --apiserver-cert-extra-sans
      </code>
      arguments, lowercased if necessary.
    </p>
  </li>
  <li>
    <p>
      Writes kubeconfig files in
      <code>
        /etc/kubernetes/
      </code>
      for
      the kubelet, the controller-manager and the scheduler to use to connect to the
      API server, each with its own identity, as well as an additional
      kubeconfig file for administration named
      <code>
        admin.conf
      </code>
      .
    </p>
  </li>
  <li>
    <p>
      Generates static Pod manifests for the API server,
      controller-manager and scheduler. In case an external etcd is not provided,
      an additional static Pod manifest is generated for etcd.
    </p>
    <p>
      Static Pod manifests are written to
      <code>
        /etc/kubernetes/manifests
      </code>
      ; the kubelet
      watches this directory for Pods to create on startup.
    </p>
    <p>
      Once control plane Pods are up and running, the
      <code>
        kubeadm init
      </code>
      sequence can continue.
    </p>
  </li>
  <li>
    <p>
      Apply labels and taints to the control-plane node so that no additional workloads will
      run there.
    </p>
  </li>
  <li>
    <p>
      Generates the token that additional nodes can use to register
      themselves with a control-plane in the future. Optionally, the user can provide a
      token via
      <code>
        --token
      </code>
      , as described in the
      <a href="/docs/reference/setup-tools/kubeadm/kubeadm-token/">
        kubeadm token
      </a>
      docs.
    </p>
  </li>
  <li>
    <p>
      Makes all the necessary configurations for allowing node joining with the
      <a href="/docs/reference/access-authn-authz/bootstrap-tokens/">
        Bootstrap Tokens
      </a>
      and
      <a href="/docs/reference/command-line-tools-reference/kubelet-tls-bootstrapping/">
        TLS Bootstrap
      </a>
      mechanism:
    </p>
    <ul>
      <li>
        <p>
          Write a ConfigMap for making available all the information required
          for joining, and set up related RBAC access rules.
        </p>
      </li>
      <li>
        <p>
          Let Bootstrap Tokens access the CSR signing API.
        </p>
      </li>
      <li>
        <p>
          Configure auto-approval for new CSR requests.
        </p>
      </li>
    </ul>
    <p>
      See
      <a href="/docs/reference/setup-tools/kubeadm/kubeadm-join/">
        kubeadm join
      </a>
      for additional info.
    </p>
  </li>
  <li>
    <p>
      Installs a DNS server (CoreDNS) and the kube-proxy addon components via the API server.
      In Kubernetes version 1.11 and later CoreDNS is the default DNS server.
      To install kube-dns instead of CoreDNS, the DNS addon has to be configured in the kubeadm
      <code>
        ClusterConfiguration
      </code>
      .
      For more information about the configuration see the section
      <code>
        Using kubeadm init with a configuration file
      </code>
      below.
      Please note that although the DNS server is deployed, it will not be scheduled until CNI is installed.
    </p>
    <blockquote class="warning">
  </li>
</ol>
<div>
  <strong>
    Warning:
  </strong>
  kube-dns usage with kubeadm is deprecated as of v1.18 and will be removed in a future release.
</div>
<h3 id="init-phases">
  Using init phases with kubeadm
</h3>
<p>
  Kubeadm allows you to create a control-plane node in phases using the
  <code>
    kubeadm init phase
  </code>
  command.
</p>
<p>
  To view the ordered list of phases and sub-phases you can call
  <code>
    kubeadm init --help
  </code>
  . The list will be located at the top of the help screen and each phase will have a description next to it.
  Note that by calling
  <code>
    kubeadm init
  </code>
  all of the phases and sub-phases will be executed in this exact order.
</p>
<p>
  Some phases have unique flags, so if you want to have a look at the list of available options add
  <code>
    --help
  </code>
  , for example:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo kubeadm init phase control-plane controller-manager --help</code></pre>
</div>
<p>
  You can also use
  <code>
    --help
  </code>
  to see the list of sub-phases for a certain parent phase:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo kubeadm init phase control-plane --help</code></pre>
</div>
<p>
  <code>
    kubeadm init
  </code>
  also exposes a flag called
  <code>
    --skip-phases
  </code>
  that can be used to skip certain phases. The flag accepts a list of phase names and the names can be taken from the above ordered list.
</p>
<p>
  An example:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo kubeadm init phase control-plane all --config<span style="color:#666">=</span>configfile.yaml
sudo kubeadm init phase etcd <span style="color:#a2f">local</span> --config<span style="color:#666">=</span>configfile.yaml
<span style="color:#080;font-style:italic"># you can now modify the control plane and etcd manifest files</span>
sudo kubeadm init --skip-phases<span style="color:#666">=</span>control-plane,etcd --config<span style="color:#666">=</span>configfile.yaml</code></pre>
</div>
<p>
  What this example would do is write the manifest files for the control plane and etcd in
  <code>
    /etc/kubernetes/manifests
  </code>
  based on the configuration in
  <code>
    configfile.yaml
  </code>
  . This allows you to modify the files and then skip these phases using
  <code>
    --skip-phases
  </code>
  . By calling the last command you will create a control plane node with the custom manifest files.
</p>
<h3 id="config-file">
  Using kubeadm init with a configuration file
</h3>
<blockquote class="caution">
  <div>
    <strong>
      Caution:
    </strong>
    The config file is still considered beta and may change in future versions.
  </div>
</blockquote>
<p>
  It&rsquo;s possible to configure
  <code>
    kubeadm init
  </code>
  with a configuration file instead of command
  line flags, and some more advanced features may only be available as
  configuration file options. This file is passed with the
  <code>
    --config
  </code>
  option.
</p>
<p>
  The default configuration can be printed out using the
  <a href="/docs/reference/setup-tools/kubeadm/kubeadm-config/">
    kubeadm config print
  </a>
  command.
</p>
<p>
  It is
  <strong>
    recommended
  </strong>
  that you migrate your old
  <code>
    v1beta1
  </code>
  configuration to
  <code>
    v1beta2
  </code>
  using
  the
  <a href="/docs/reference/setup-tools/kubeadm/kubeadm-config/">
    kubeadm config migrate
  </a>
  command.
</p>
<p>
  For more details on each field in the
  <code>
    v1beta2
  </code>
  configuration you can navigate to our
  <a href="https://godoc.org/k8s.io/kubernetes/cmd/kubeadm/app/apis/kubeadm/v1beta2">
    API reference pages
  </a>
  .
</p>
<h3 id="kube-proxy">
  Adding kube-proxy parameters
</h3>
<p>
  For information about kube-proxy parameters in the kubeadm configuration see:
</p>
<ul>
  <li>
    <a href="https://godoc.org/k8s.io/kubernetes/pkg/proxy/apis/config#KubeProxyConfiguration">
      kube-proxy
    </a>
  </li>
</ul>
<p>
  For information about enabling IPVS mode with kubeadm see:
</p>
<ul>
  <li>
    <a href="https://github.com/kubernetes/kubernetes/blob/master/pkg/proxy/ipvs/README.md">
      IPVS
    </a>
  </li>
</ul>
<h3 id="control-plane-flags">
  Passing custom flags to control plane components
</h3>
<p>
  For information about passing flags to control plane components see:
</p>
<ul>
  <li>
    <a href="/docs/setup/production-environment/tools/kubeadm/control-plane-flags/">
      control-plane-flags
    </a>
  </li>
</ul>
<h3 id="custom-images">
  Using custom images
</h3>
<p>
  By default, kubeadm pulls images from
  <code>
    k8s.gcr.io
  </code>
  . If the
  requested Kubernetes version is a CI label (such as
  <code>
    ci/latest
  </code>
  )
  <code>
    gcr.io/kubernetes-ci-images
  </code>
  is used.
</p>
<p>
  You can override this behavior by using
  <a href="#config-file">
    kubeadm with a configuration file
  </a>
  .
  Allowed customization are:
</p>
<ul>
  <li>
    To provide an alternative
    <code>
      imageRepository
    </code>
    to be used instead of
    <code>
      k8s.gcr.io
    </code>
    .
  </li>
  <li>
    To set
    <code>
      useHyperKubeImage
    </code>
    to
    <code>
      true
    </code>
    to use the HyperKube image.
  </li>
  <li>
    To provide a specific
    <code>
      imageRepository
    </code>
    and
    <code>
      imageTag
    </code>
    for etcd or DNS add-on.
  </li>
</ul>
<p>
  Please note that the configuration field
  <code>
    kubernetesVersion
  </code>
  or the command line flag
  <code>
    --kubernetes-version
  </code>
  affect the version of the images.
</p>
<h3 id="uploading-control-plane-certificates-to-the-cluster">
  Uploading control-plane certificates to the cluster
</h3>
<p>
  By adding the flag
  <code>
    --upload-certs
  </code>
  to
  <code>
    kubeadm init
  </code>
  you can temporary upload
  the control-plane certificates to a Secret in the cluster. Please note that this Secret
  will expire automatically after 2 hours. The certificates are encrypted using
  a 32byte key that can be specified using
  <code>
    --certificate-key
  </code>
  . The same key can be used
  to download the certificates when additional control-plane nodes are joining, by passing
  <code>
    --control-plane
  </code>
  and
  <code>
    --certificate-key
  </code>
  to
  <code>
    kubeadm join
  </code>
  .
</p>
<p>
  The following phase command can be used to re-upload the certificates after expiration:
</p><pre><code>kubeadm init phase upload-certs --upload-certs --certificate-key=SOME_VALUE --config=SOME_YAML_FILE</code></pre>
<p>
  If the flag
  <code>
    --certificate-key
  </code>
  is not passed to
  <code>
    kubeadm init
  </code>
  and
  <code>
    kubeadm init phase upload-certs
  </code>
  a new key will be generated automatically.
</p>
<p>
  The following command can be used to generate a new key on demand:
</p><pre><code>kubeadm alpha certs certificate-key</code></pre>
<h3 id="certificate-management-with-kubeadm">
  Certificate management with kubeadm
</h3>
<p>
  For detailed information on certificate management with kubeadm see
  <a href="/docs/tasks/administer-cluster/kubeadm/kubeadm-certs/">
    Certificate Management with kubeadm
  </a>
  .
  The document includes information about using external CA, custom certificates
  and certificate renewal.
</p>
<h3 id="kubelet-drop-in">
  Managing the kubeadm drop-in file for the kubelet
</h3>
<p>
  The
  <code>
    kubeadm
  </code>
  package ships with a configuration file for running the
  <code>
    kubelet
  </code>
  by
  <code>
    systemd
  </code>
  . Note that the kubeadm CLI never touches this drop-in file. This drop-in file is part of the kubeadm DEB/RPM package.
</p>
<p>
  For further information, see
  <a href="/docs/setup/production-environment/tools/kubeadm/kubelet-integration/#the-kubelet-drop-in-file-for-systemd">
    Managing the kubeadm drop-in file for systemd
  </a>
  .
</p>
<h3 id="use-kubeadm-with-cri-runtimes">
  Use kubeadm with CRI runtimes
</h3>
<p>
  By default kubeadm attempts to detect your container runtime. For more details on this detection, see
  the
  <a href="/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#installing-runtime">
    kubeadm CRI installation guide
  </a>
  .
</p>
<h3 id="setting-the-node-name">
  Setting the node name
</h3>
<p>
  By default,
  <code>
    kubeadm
  </code>
  assigns a node name based on a machine&rsquo;s host address. You can override this setting with the
  <code>
    --node-name
  </code>
  flag.
  The flag passes the appropriate
  <a href="/docs/reference/command-line-tools-reference/kubelet/#options">
    <code>
      --hostname-override
    </code>
  </a>
  value to the kubelet.
</p>
<p>
  Be aware that overriding the hostname can
  <a href="https://github.com/kubernetes/website/pull/8873">
    interfere with cloud providers
  </a>
  .
</p>
<h3 id="running-kubeadm-without-an-internet-connection">
  Running kubeadm without an internet connection
</h3>
<p>
  For running kubeadm without an internet connection you have to pre-pull the required control-plane images.
</p>
<p>
  You can list and pull the images using the
  <code>
    kubeadm config images
  </code>
  sub-command:
</p>
<div class="highlight">
  <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubeadm config images list
kubeadm config images pull</code></pre>
</div>
<p>
  All images that kubeadm requires such as
  <code>
    k8s.gcr.io/kube-*
  </code>
  ,
  <code>
    k8s.gcr.io/etcd
  </code>
  and
  <code>
    k8s.gcr.io/pause
  </code>
  support multiple architectures.
</p>
<h3 id="automating-kubeadm">
  Automating kubeadm
</h3>
<p>
  Rather than copying the token you obtained from
  <code>
    kubeadm init
  </code>
  to each node, as
  in the
  <a href="/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/">
    basic kubeadm tutorial
  </a>
  , you can parallelize the
  token distribution for easier automation. To implement this automation, you must
  know the IP address that the control-plane node will have after it is started,
  or use a DNS name or an address of a load balancer.
</p>
<ol>
  <li>
    <p>
      Generate a token. This token must have the form
      <code>
        &lt;6 character string&gt;.&lt;16 character string&gt;
      </code>
      . More formally, it must match the regex:
      <code>
        [a-z0-9]{6}\.[a-z0-9]{16}
      </code>
      .
    </p>
    <p>
      kubeadm can generate a token for you:
    </p>
    <div class="highlight">
      <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubeadm token generate</code></pre>
    </div>
  </li>
  <li>
    <p>
      Start both the control-plane node and the worker nodes concurrently with this token.
      As they come up they should find each other and form the cluster.  The same
      <code>
        --token
      </code>
      argument can be used on both
      <code>
        kubeadm init
      </code>
      and
      <code>
        kubeadm join
      </code>
      .
    </p>
  </li>
  <li>
    <p>
      Similar can be done for
      <code>
        --certificate-key
      </code>
      when joining additional control-plane
      nodes. The key can be generated using:
    </p>
    <div class="highlight">
      <pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubeadm alpha certs certificate-key</code></pre>
    </div>
  </li>
</ol>
<p>
  Once the cluster is up, you can grab the admin credentials from the control-plane node
  at
  <code>
    /etc/kubernetes/admin.conf
  </code>
  and use that to talk to the cluster.
</p>
<p>
  Note that this style of bootstrap has some relaxed security guarantees because
  it does not allow the root CA hash to be validated with
  <code>
    --discovery-token-ca-cert-hash
  </code>
  (since it&rsquo;s not generated when the nodes are
  provisioned). For details, see the
  <a href="/docs/reference/setup-tools/kubeadm/kubeadm-join/">
    kubeadm join
  </a>
  .
</p>
<h2 id="what-s-next">
  What&#39;s next
</h2>
<ul>
  <li>
    <a href="/docs/reference/setup-tools/kubeadm/kubeadm-init-phase/">
      kubeadm init phase
    </a>
    to understand more about
    <code>
      kubeadm init
    </code>
    phases
  </li>
  <li>
    <a href="/docs/reference/setup-tools/kubeadm/kubeadm-join/">
      kubeadm join
    </a>
    to bootstrap a Kubernetes worker node and join it to the cluster
  </li>
  <li>
    <a href="/docs/reference/setup-tools/kubeadm/kubeadm-upgrade/">
      kubeadm upgrade
    </a>
    to upgrade a Kubernetes cluster to a newer version
  </li>
  <li>
    <a href="/docs/reference/setup-tools/kubeadm/kubeadm-reset/">
      kubeadm reset
    </a>
    to revert any changes made to this host by
    <code>
      kubeadm init
    </code>
    or
    <code>
      kubeadm join
    </code>
  </li>
</ul>